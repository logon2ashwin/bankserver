var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.findInternal=function(e,t,n){var a,s,i;for(e instanceof String&&(e+=""),a=e.length,s=0;s<a;s++)if(i=e[s],t.call(n,i,s,e))return{i:s,v:i};return{i:-1,v:void 0}},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.polyfill=function(e,t,n,a){if(t){for(n=$jscomp.global,e=e.split("."),a=0;a<e.length-1;a++){var s=e[a];s in n||(n[s]={}),n=n[s]}e=e[e.length-1],a=n[e],t=t(a),t!=a&&null!=t&&$jscomp.defineProperty(n,e,{configurable:!0,writable:!0,value:t})}},$jscomp.polyfill("Array.prototype.find",function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).v}},"es6","es3"),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.Symbol=function(){var e=0;return function(t){return $jscomp.SYMBOL_PREFIX+(t||"")+e++}}(),$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(e){var t=0;return $jscomp.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},$jscomp.iteratorPrototype=function(e){return $jscomp.initSymbolIterator(),e={next:e},e[$jscomp.global.Symbol.iterator]=function(){return this},e},$jscomp.iteratorFromArray=function(e,t){$jscomp.initSymbolIterator(),e instanceof String&&(e+="");var n=0,a={next:function(){if(n<e.length){var s=n++;return{value:t(s,e[s]),done:!1}}return a.next=function(){return{done:!0,value:void 0}},a.next()}};return a[Symbol.iterator]=function(){return a},a},$jscomp.polyfill("Array.prototype.keys",function(e){return e||function(){return $jscomp.iteratorFromArray(this,function(e){return e})}},"es6","es3"),function(e){function t(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=42)}([function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("request")},function(e,t,n){t=function(e){e=n(0);var t=e.Schema;t=new t({status:{type:String,default:""},date:{type:String,default:""},auto_match_id:{type:String,default:""},auto_match_link:{type:String,default:""},auto_match_guid:{type:String,default:""},scoreupdate:{type:String,default:"manual"},match_type:{type:String,default:""},match_view_status:{type:String,default:"active"},innings:{first:{type:String,default:""},second:{type:String,default:""},third:{type:String,default:""},fourth:{type:String,default:""},current:{type:String,default:"0"}},currentoverscore:{type:Number,default:"0"},team_1:{teamid:{type:t.Types.ObjectId,ref:"activeteam"},overs:{type:Number,default:0},balls:{type:Number,default:0},scores:{type:Number,default:0},wickets:{type:Number,default:0},second_innings_overs:{type:Number,default:0},second_innings_balls:{type:Number,default:0},second_innings_scores:{type:Number,default:0},second_innings_wickets:{type:Number,default:0},wide:{type:Number,default:0},noball:{type:Number,default:0},byes:{type:Number,default:0},legbyes:{type:Number,default:0},second_innings_wide:{type:Number,default:0},second_innings_noball:{type:Number,default:0},second_innings_byes:{type:Number,default:0},second_innings_legbyes:{type:Number,default:0},toss:Boolean,status:{type:Boolean,default:!1},totalovers:Number,targetscore:Number,runrate:{type:String,default:"0.00"},battingcompleted:{type:Boolean,default:!1},scorecard:[{innings:{type:Number},player_id:{type:t.Types.ObjectId,ref:"playerlist"},player_name:{type:String},wicket:{type:Number,default:0},score:{type:Number},balls:{type:Number},wicket_type:{type:String},striker_end_batsman:{type:Boolean,default:!1},playing:{type:Boolean,default:!1},wicket_by:{type:String},wicket_notes:{type:String,default:""},sixes:{type:Number,default:0},fours:{type:Number,default:0},strike_rate:{type:Number,default:0}}],scorecard_auto:[{innings:{type:Number},player_name:{type:String},wicket:{type:Number,default:0},score:{type:Number},balls:{type:Number},striker_end_batsman:{type:Boolean,default:!1},playing:{type:Boolean,default:!1},wicket_type:{type:String},wicket_by:{type:String},wicket_notes:{type:String},sixes:{type:Number,default:0},fours:{type:Number,default:0},strike_rate:{type:Number,default:0}}],bowler_scorecard:[{player_id:{type:t.Types.ObjectId,ref:"playerlist"},innings:{type:Number,default:1},player_name:{type:String},numberofwickets:{type:Number,default:0},playing:{type:Boolean,default:!1},maiden:{type:Number,default:0},economy:{type:Number},runs:{type:Number},balls:{type:Number}}],bowler_scorecard_auto:[{innings:{type:Number},player_name:{type:String},overs:{type:String},numberofwickets:{type:Number,default:0},playing:{type:Boolean,default:!1},runs:{type:Number},balls:{type:Number},economy:{type:Number},dots:{type:Number},maiden:{type:Number,default:0},fours:{type:Number},sixes:{type:Number},wide:{type:Number},noball:{type:Number}}],fall_of_wickets:[{innings:{type:Number},player_id:{type:t.Types.ObjectId,ref:"playerlist"},player_name:{type:String},overs:{type:String},balls:{type:Number},wicket_position:{type:Number},score:{type:Number}}]},team_2:{teamid:{type:t.Types.ObjectId,ref:"activeteam"},overs:{type:Number,default:0},balls:{type:Number,default:0},scores:{type:Number,default:0},wickets:{type:Number,default:0},second_innings_overs:{type:Number,default:0},second_innings_balls:{type:Number,default:0},second_innings_scores:{type:Number,default:0},second_innings_wickets:{type:Number,default:0},wide:{type:Number,default:0},noball:{type:Number,default:0},byes:{type:Number,default:0},legbyes:{type:Number,default:0},second_innings_wide:{type:Number,default:0},second_innings_noball:{type:Number,default:0},second_innings_byes:{type:Number,default:0},second_innings_legbyes:{type:Number,default:0},toss:Boolean,status:{type:Boolean,default:!1},totalovers:Number,targetscore:Number,runrate:{type:String,default:"0.00"},battingcompleted:{type:Boolean,default:!1},scorecard:[{innings:{type:Number},player_id:{type:t.Types.ObjectId,ref:"playerlist"},player_name:{type:String},wicket:{type:Number,default:0},striker_end_batsman:{type:Boolean,default:!1},playing:{type:Boolean,default:!1},score:{type:Number},balls:{type:Number},wicket_notes:{type:String,default:""},wicket_type:{type:String},wicket_by:{type:String},sixes:{type:Number,default:0},fours:{type:Number,default:0},strike_rate:{type:String,default:0}}],scorecard_auto:[{innings:{type:Number},player_name:{type:String},wicket:{type:Number,default:0},striker_end_batsman:{type:Boolean,default:!1},playing:{type:Boolean,default:!1},overs:{type:Number},score:{type:Number},balls:{type:Number},wicket_type:{type:String},wicket_by:{type:String},wicket_notes:{type:String,default:""},sixes:{type:Number,default:0},fours:{type:Number,default:0},strike_rate:{type:String,default:0}}],bowler_scorecard:[{player_id:{type:t.Types.ObjectId,ref:"playerlist"},innings:{type:Number,default:1},player_name:{type:String},playing:{type:Boolean,default:!1},numberofwickets:{type:Number,default:0},maiden:{type:Number,default:0},economy:{type:Number},runs:{type:Number},balls:{type:Number}}],bowler_scorecard_auto:[{innings:{type:Number},player_name:{type:String},playing:{type:Boolean,default:!1},numberofwickets:{type:Number,default:0},overs:{type:String},runs:{type:Number},balls:{type:Number},economy:{type:Number},dots:{type:Number},maiden:{type:Number,default:0},fours:{type:Number},sixes:{type:Number},wide:{type:Number},noball:{type:Number}}],fall_of_wickets:[{innings:{type:Number},player_id:{type:t.Types.ObjectId,ref:"playerlist"},player_name:{type:String},overs:{type:String},balls:{type:Number},wicket_position:{type:Number},score:{type:Number}}]},tournament:{type:t.Types.ObjectId,ref:"tournament"},session_overs:{type:Number,default:0},session_rate:{type:Number,default:0},session_rate1:{type:Number,default:0},market_rate:{type:Number,default:0},market_rate1:{type:Number,default:0},fav_team:{type:String,default:"None"},current_match_status:{type:String,default:"none"},match_details:{type:String,default:"-"},match_venue:{type:String,default:"-"},created_At:{type:Date},updated_At:{type:Date}}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("matchlist"))return e.model("matchlist")}catch(n){if("MissingSchemaError"===n.name)return e.model("matchlist",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){e=n(0);var t=e.Schema;t=new t({match_id:{type:t.Types.ObjectId,ref:"matchlists"},team:{type:t.Types.ObjectId,ref:"activeteam"},innings:{type:Number,default:0},batsman_id:[{player_name:{type:String},runs:{type:Number},balls:{type:Number},fours:{type:Number},sixes:{type:Number},strike_rate:{type:Number},age:{type:Number},type:{type:String}}],active_batsman:{player_name:{type:String},runs:{type:Number},balls:{type:Number},fours:{type:Number},sixes:{type:Number},strike_rate:{type:Number},age:{type:Number},type:{type:String}},active_bowler:{player_name:{type:String},age:{type:Number},type:{type:String},overs:{type:String},runs:{type:Number},economy:{type:Number},wicket:{type:Number}},previous_bowler:{player_name:{type:String},age:{type:Number},type:{type:String},overs:{type:String},runs:{type:Number},economy:{type:Number},wicket:{type:Number}},event:{six:{type:Number,default:0},four:{type:Number,default:0},three:{type:Number,default:0},two:{type:Number,default:0},one:{type:Number,default:0},dot:{type:Number},noball:{type:Number},freehit:{type:Number},wide:{type:Number},leg_bye:{type:Number},bye:{type:Number},wicket:{type:Number,default:0},wicket_type:{type:String},wicket_by:{type:String},third_player:{player_name:{type:String},age:{type:Number},type:{type:String}},wicket_notes:{type:String}},balls:{type:Number,default:0},overs:{type:Number,default:0},notes:{type:String,default:null}}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("scoresauto"))return e.model("scoresauto")}catch(n){if("MissingSchemaError"===n.name)return e.model("scoresauto",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){e=n(0);var t=e.Schema;t=new t({match_id:{type:t.Types.ObjectId,ref:"matchlists"},ball:{type:Number},over:{type:Number},text:{type:String},team:{type:String},innings:{type:Number,default:1},updated_At:{type:Date},created_At:{type:Date}}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("commentary"))return e.model("commentary")}catch(n){if("MissingSchemaError"===n.name)return e.model("commentary",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){e.exports={getconfig:function(){if(n(18),process.env.ENVIRONMENT)var e=n(18);else e=n(30),console.log("Set ENVIRONMENT=dev|test|prod");return e}}},function(e,t,n){t=function(e){e=n(0);var t=e.Schema;t=new t({team_name:{type:String},short_name:{type:String},country:{type:String},alias:{type:String},autofetch:{type:String,default:"off"},flag:{type:String},active_players:[{type:t.Types.ObjectId,ref:"playerlist"}]}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("activeteam"))return e.model("activeteam")}catch(n){if("MissingSchemaError"===n.name)return e.model("activeteam",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){e=n(0);var t=new e.Schema({tournament_name:{type:String},overs:{type:Number}});t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("tournament"))return e.model("tournament")}catch(n){if("MissingSchemaError"===n.name)return e.model("tournament",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){var t,a;e=n(0),t=e.Schema,n(19),n(14),a=n(20)(e),t=new t({name:{type:String},country:{type:String},phone:{type:String},profilepicture:{type:String},email:{type:String},username:{type:String},password:{type:String},social_name:{type:String},socialtype:{type:String},socialid:{type:String},social_token:{type:String},role:{type:String,enum:["admin","leader","scorer","user"],default:"user"},cd:{type:Date,default:Date.now}}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()}),t.plugin(a,{});try{if(e.model("accounts"))return e.model("accounts")}catch(n){if("MissingSchemaError"===n.name)return console.log("Registered Model: accounts"),e.model("accounts",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){e=n(0);var t=e.Schema;t=new t({match_id:{type:t.Types.ObjectId,ref:"matchlists"},ball:{type:Number},over:{type:Number},innings:{type:Number},notification_type:{type:String},team:{type:String},wicket:{type:Number},title:{type:String},body:{type:String},match_result:{type:String},updated_At:{type:Date},created_At:{type:Date}}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("pushnotifications"))return e.model("pushnotifications")}catch(n){if("MissingSchemaError"===n.name)return e.model("pushnotifications",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){e.exports={sendscorecard:function(e,t,a,s){function i(e,t,n,a,s,i){"auto"==n.scoreupdate?a.scoresauto.find(s).populate("team").exec(function(n,a){i(e,t,n,a)}):a.scores.find(s).populate("batsman_id").populate("bowler_id").populate("active_batsman").populate("active_bowler").populate("team").exec(function(n,a){i(e,t,n,a)})}var o="none",r=n(28);"none"!=(o="http"==s?e.params.id:a.matchID)&&a.match.findOne({_id:o}).populate("team_1.teamid").populate("team_2.teamid").populate("tournament").exec(function(n,c){var l,d,u;n?"http"==s?t.send({status:"error"}):(void 0!==e.app?e.app.get("socketio"):a.socketio).sockets.emit({status:"error"}):(l={match:{}},c?(l.match=c,n={},n.match_id=o,1==c.team_1.status?(n.team=c.team_1.teamid._id,n.balls=c.team_1.balls,n.overs=c.team_1.overs):(n.team=c.team_2.teamid._id,n.balls=c.team_2.balls,n.overs=c.team_2.overs),l.reqrunrate=0,c.team_1.battingcompleted?(d=c.team_2.scores,u=c.team_2.overs,l.reqrunrate=0==c.team_2.balls?d/u:d/((6*u+c.team_2.balls)/6),"auto"==c.scoreupdate&&(l.reqrunrate=parseFloat(c.team_2.runrate))):c.team_2.battingcompleted&&(d=c.team_1.scores,u=c.team_1.overs,l.reqrunrate=0==c.team_1.balls?d/u:d/((6*u+c.team_1.balls)/6),"auto"==c.scoreupdate&&(l.reqrunrate=parseFloat(c.team_1.runrate))),l.innings={},(void 0!==c.team_1.toss||void 0!==c.team_1.toss)&&(c.team_1.toss||c.team_2.toss)?(c.team_1.battingcompleted||c.team_2.battingcompleted?(c.team_1.battingcompleted?(l.innings.current="2",l.innings.first="team1",l.innings.second="team2"):(l.innings.current="2",l.innings.first="team2",l.innings.second="team1"),c.team_1.battingcompleted&&c.team_2.battingcompleted&&(l.innings.current="completed")):c.team_1.status?(l.innings.current="1",l.innings.first="team1",l.innings.second="team2"):(l.innings.current="1",l.innings.first="team2",l.innings.second="team1"),"auto"==c.scoreupdate&&(l.innings.first=c.innings.first,l.innings.second=c.innings.second,l.innings.third=c.innings.third,l.innings.fourth=c.innings.fourth,l.innings.current=c.innings.current)):(l.innings.current="0",l.innings.first="none",l.innings.second="none"),"auto"==l.match.scoreupdate&&(l.match.team_1.scorecard=l.match.team_1.scorecard_auto,l.match.team_2.scorecard=l.match.team_2.scorecard_auto,l.match.team_1.bowler_scorecard=l.match.team_1.bowler_scorecard_auto,l.match.team_2.bowler_scorecard=l.match.team_2.bowler_scorecard_auto),l.reqrunrate=l.reqrunrate.toFixed(2),i(e,t,l.match,a,n,function(e,t,n,i){n?"http"==s?t.send({status:"error"}):(void 0!==e.app?e.app.get("socketio"):a.socketio).sockets.emit({status:"error"}):(n={event:{},_id:0},0<i.length&&(n=i[i.length-1]),void 0===n.event.dot&&(n.event.dot=0),void 0===n.event.six&&(n.event.six=0),void 0===n.event.four&&(n.event.four=0),void 0===n.event.three&&(n.event.three=0),void 0===n.event.two&&(n.event.two=0),void 0===n.event.one&&(n.event.one=0),void 0===n.event.dot&&(n.event.dot=0),void 0===n.event.noball&&(n.event.noball=0),void 0===n.event.freehit&&(n.event.freehit=0),void 0===n.event.wide&&(n.event.wide=0),void 0===n.event.leg_bye&&(n.event.leg_bye=0),void 0===n.event.bye&&(n.event.bye=0),void 0===n.event.wicket&&(n.event.wicket=0),void 0===n.event.wicket_type&&(n.event.wicket_type=""),void 0===n.event.wicket_notes&&(n.event.wicket_notes=""),l.scores=n,i={match_id:o},"1"==l.innings.current&&("team1"==l.innings.first&&(i.over=l.match.team_1.overs,i.team="team1"),"team2"==l.innings.first&&(i.over=l.match.team_2.overs,i.team="team2")),"2"==l.innings.current&&("team1"==l.innings.second&&(i.team="team1",i.over=l.match.team_1.overs),"team2"==l.innings.second&&(i.team="team2",i.over=l.match.team_2.overs)),a.Commentaries.find(i).sort({over:-1,ball:-1}).limit(6).exec(function(n,i){n?"http"==s?t.send({status:"error"}):(n=void 0!==e.app?e.app.get("socketio"):a.socketio,n.sockets.emit({status:"error"})):(l.commentary=i,"http"==s?t.send({status:"success",results:l}):(n=void 0!==e.app?e.app.get("socketio"):a.socketio,n.emit("scorecard",{status:"success",results:l}),r.pushmatchresult({matchdetails:l.match},function(){}),r.pushwicket({matchdetails:l.match},function(){})))}))})):t.send({status:"no_results",results:l}))})}}},function(e,t,n){t=function(e){e=n(0);var t=e.Schema;t=new t({match_id:{type:t.Types.ObjectId,ref:"playerlist"},team:{type:t.Types.ObjectId,ref:"activeteam"},innings:{type:Number,default:0},batsman_id:[{type:t.Types.ObjectId,ref:"playerlist"}],active_batsman:{type:t.Types.ObjectId,ref:"playerlist"},active_bowler:{type:t.Types.ObjectId,ref:"playerlist"},previous_bowler:{type:t.Types.ObjectId,ref:"playerlist"},event:{six:{type:Number,default:0},four:{type:Number,default:0},three:{type:Number,default:0},two:{type:Number,default:0},one:{type:Number,default:0},dot:{type:Number},noball:{type:Number},freehit:{type:Number},wide:{type:Number},leg_bye:{type:Number},bye:{type:Number},wicket:{type:Number,default:0},wicket_type:{type:String},wicket_by:{type:String},third_player:{type:t.Types.ObjectId,ref:"playerlist"},wicket_notes:{type:String}},balls:{type:Number,default:0},overs:{type:Number,default:0},notes:{type:String,default:null}}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("score"))return e.model("score")}catch(n){if("MissingSchemaError"===n.name)return e.model("score",t)}},e.exports={getModel:t,registerModel:t}},function(e,t){e.exports=require("cheerio")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("crypto")},function(e,t,n){t=function(e){e=n(0);var t=n(33),a=e.Schema;a=new a({projectid:{type:String},projectleadid:{type:a.Types.ObjectId,ref:"projectleads"},campaignid:{type:String},clientid:{type:String},receipientemail:{type:String},subject:{type:String},message:{type:String},updated_At:{type:Date},created_At:{type:Date},casessionid:{type:String},causerid:{type:String},attachments:[{type:a.Types.ObjectId,ref:"attachments",required:!0}],attachmentlinks:[{type:String}]}),a.plugin(t),a.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("emails"))return e.model("emails")}catch(t){if("MissingSchemaError"===t.name)return e.model("emails",a)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){e=n(0);var t=new e.Schema({title:{type:String},description:{type:String},link:{type:String},guid:{type:String},pubdate:{type:String},content:{type:String},headerimage:{type:String},created_At:{type:Date},updated_At:{type:Date}});t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("newsfeed"))return e.model("newsfeed")}catch(n){if("MissingSchemaError"===n.name)return e.model("newsfeed",t)}},e.exports={getModel:t,registerModel:t}},function(e,t){e.exports={isemptyObj:function(e){return void 0===e||0<Object.keys(e).length},isvalidData:function(e){return void 0!==e&&(null!=e&&(0<e.length&&"null"!=e&&"undefined"!=e))}}},function(e,t){e.exports={service:{host:"http://cricwormapi.clofus.com",port:8e3,apiversion:"v1",baseurl:"http://cricworm.clofus.com"},database:{host:"localhost",port:27017,db:"cricworm",username:"cricworm",password:"7Qwerty706",replicaset:!1},email:{username:"support@clofus.com",password:"0182680c955d37f1ba707640aba9b0ed",from:"support@clofus.com",service:"mailgun",host:"smtp.mailgun.org",port:587,trackerimage:"/logo_tiny.png"}}},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("mongoose-deep-populate")},function(e,t,n){t=function(e){var t,a;e=n(0),t=e.Schema,n(19),n(14),a=n(20)(e),t=new t({filename:{type:String},projectid:{type:t.Types.ObjectId,ref:"projects"},emailid:{type:t.Types.ObjectId,ref:"emails"},clientid:{type:String},causerid:{type:String},casessionid:{type:String},created_At:{type:Date},updated_At:{type:Date}}),t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()}),t.plugin(a,{});try{if(e.model("attachments"))return e.model("attachments")}catch(n){if("MissingSchemaError"===n.name)return console.log("Registered Model: attachments"),e.model("attachments",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){e=n(0);var t=new e.Schema({user_id:{type:String,required:!0},token:{type:String},session:{type:Date,default:Date.now}});t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("oauths"))return e.model("oauths")}catch(n){if("MissingSchemaError"===n.name)return e.model("oauths",t)}},e.exports={getModel:t,registerModel:t}},function(e,t,n){t=function(e){e=n(0);var t=new e.Schema({player_name:{type:String},age:{type:Number},type:{type:String}});t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("playerlist"))return e.model("playerlist")}catch(n){if("MissingSchemaError"===n.name)return e.model("playerlist",t)}},e.exports={getModel:t,registerModel:t}},function(e,t){e.exports=require("xml2js")},function(e,t){e.exports=require("express")},function(e,t,n){t=function(e){e=n(0);var t=new e.Schema({event:{type:String},filename:{type:String,default:""},created_At:{type:Date},updated_At:{type:Date}});t.pre("save",function(e){var t=new Date;this.updated_At=t,this.created_At||(this.created_At=t),e()});try{if(e.model("gifs"))return e.model("gifs")}catch(n){if("MissingSchemaError"===n.name)return e.model("gifs",t)}},e.exports={getModel:t,registerModel:t}},function(e,t){e.exports=require("moment")},function(e,t,n){e.exports={send:function(e,t){var a,s,i=n(1),o=n(9).getModel();e.notification_type="all",a={notification:{}},a.notification.title=e.matchdetails.team_1.teamid.team_name+" vs "+e.matchdetails.team_2.teamid.team_name,a.to="/topics/M_"+e.match_id+"_"+e.notification_type,s={},"match_status"==e.notification_msg_type?(s.match_id=e.match_id,s.innings=e.innings,s.notification_type=e.notification_msg_type,a.notification.body=e.notification_body):"wicket"==e.notification_msg_type&&(s.match_id=e.match_id,s.innings=e.innings,s.wicket=e.wicket,s.notification_type=e.notification_msg_type,a.notification.body=e.notification_body),o.find(s).exec(function(n,s){n?t({status:"error",msg:"error in find"}):0==s.length?i({method:"POST",headers:{"Content-Type":"application/json",Authorization:"key=AAAA27BBYGI:APA91bFgaxvkq61FxnWArhOnPZHCUHnhZgBlInE4LC7RSS74MP7bl881fj6toBNpjmtTuRw973fy-txNhyl-rQJq8vEg3989Q0Q4hu8uRQ_MN8dcFSDbjgTJEDZuCZ-bcv12SDNpuu0a"},url:"https://fcm.googleapis.com/fcm/send",json:!0,body:a},function(n,a,s){n?t({status:"error",msg:"error in sending request"}):new o({match_id:e.match_id,title:e.title,body:e.body,innings:e.innings,over:e.over,ball:e.balls,match_result:e.match_result,notification_type:e.notification_msg_type,created_At:new Date,updated_At:new Date}).save(function(e,n){t(e?{status:"error",msg:"error in save notification"}:{status:"success",msg:"notification sent"})})}):t({status:"success",msg:"notification already sent"})})},pushwicket:function(e,t){function a(t){new c({match_id:e.matchdetails._id,notification_type:"wickets",innings:e.matchdetails.innings.current,wicket:i.wicket_position,title:o.notification.title,body:o.notification.body,created_At:new Date}).save(function(e,n){e||r({method:"POST",headers:{"Content-Type":"application/json",Authorization:"key=AAAA27BBYGI:APA91bFgaxvkq61FxnWArhOnPZHCUHnhZgBlInE4LC7RSS74MP7bl881fj6toBNpjmtTuRw973fy-txNhyl-rQJq8vEg3989Q0Q4hu8uRQ_MN8dcFSDbjgTJEDZuCZ-bcv12SDNpuu0a"},url:"https://fcm.googleapis.com/fcm/send",json:!0,body:o},function(e,n,a){t()})})}var s,i,o,r=n(1),c=n(9).getModel();t="none",s=[],i=[],o={notification:{}},o.notification.title=e.matchdetails.match_details+" - "+e.matchdetails.team_1.teamid.team_name+" vs "+e.matchdetails.team_2.teamid.team_name,o.to="/topics/M_"+e.matchdetails._id+"_all","1"==e.matchdetails.innings.current?t=e.matchdetails.innings.first:"2"==e.matchdetails.innings.current?t=e.matchdetails.innings.second:"3"==e.matchdetails.innings.current?t=e.matchdetails.innings.third:"4"==e.matchdetails.innings.current&&(t=e.matchdetails.innings.fourth),"team1"==t?(s=e.matchdetails.team_1.fall_of_wickets,currentteamdetails=e.matchdetails.team_1):"team2"==t&&(s=e.matchdetails.team_2.fall_of_wickets,currentteamdetails=e.matchdetails.team_2),"none"!=t&&0<s.length&&(i=s[s.length-1],o.notification.body=" Wicket: "+i.player_name+", "+currentteamdetails.teamid.alias+" "+i.score+"/"+i.wicket_position+" Overs "+i.overs+"."+i.balls,c.find({match_id:e.matchdetails._id,innings:e.matchdetails.innings.current,wicket:i.wicket_position,notification_type:"wickets"}).exec(function(e,t){0==t.length&&a(function(){})}))},pushmatchresult:function(e,t){function a(t){new i({match_id:e.matchdetails._id,notification_type:"match_result",match_result:e.matchdetails.current_match_status,title:o.notification.title,body:o.notification.body,created_At:new Date}).save(function(e,n){e||s({method:"POST",headers:{"Content-Type":"application/json",Authorization:"key=AAAA27BBYGI:APA91bFgaxvkq61FxnWArhOnPZHCUHnhZgBlInE4LC7RSS74MP7bl881fj6toBNpjmtTuRw973fy-txNhyl-rQJq8vEg3989Q0Q4hu8uRQ_MN8dcFSDbjgTJEDZuCZ-bcv12SDNpuu0a"},url:"https://fcm.googleapis.com/fcm/send",json:!0,body:o},function(e,n,a){t()})})}var s=n(1),i=n(9).getModel(),o={notification:{}};o.notification.title=e.matchdetails.match_details+" - "+e.matchdetails.team_1.teamid.team_name+" vs "+e.matchdetails.team_2.teamid.team_name,o.to="/topics/M_"+e.matchdetails._id+"_all",o.notification.body="Match status: "+e.matchdetails.current_match_status+" "+e.matchdetails.team_1.teamid.alias+" "+e.matchdetails.team_1.scores+"/"+e.matchdetails.team_1.wickets+" "+e.matchdetails.team_2.teamid.alias+" "+e.matchdetails.team_2.scores+"/"+e.matchdetails.team_2.wickets,"test"==e.matchdetails.match_type&&(o.notification.body="Match status: "+e.matchdetails.current_match_status+" "+e.matchdetails.team_1.teamid.alias+" "+e.matchdetails.team_1.scores+"/"+e.matchdetails.team_1.wickets+" & "+e.matchdetails.team_1.second_innings_scores+"/"+e.matchdetails.team_1.second_innings_wickets+" "+e.matchdetails.team_2.teamid.alias+" "+e.matchdetails.team_2.scores+"/"+e.matchdetails.team_2.wickets+" & "+e.matchdetails.team_2.second_innings_scores+"/"+e.matchdetails.team_2.second_innings_wickets),i.find({match_id:e.matchdetails._id,notification_type:"match_result"}).sort("-created_At").exec(function(n,s){n||(0==s.length?a(function(){t()}):0<s.length&&s[s.length-1].match_result!=e.matchdetails.current_match_status&&a(function(){t()}))})},pushsession:function(e,t){var a=n(1),s={notification:{}};s.notification.title=e.matchdetails.match_details+" - "+e.matchdetails.team_1.teamid.team_name+" vs "+e.matchdetails.team_2.teamid.team_name,s.to="/topics/M_"+e.matchdetails._id+"_all",s.notification.body="Favourite Team: "+e.matchdetails.fav_team+"  Market Rate: "+e.matchdetails.market_rate+" - "+e.matchdetails.market_rate1+" Session Rate: (Over "+e.matchdetails.session_overs+" / Rate "+e.matchdetails.session_rate+" - "+e.matchdetails.session_rate1+")",a({method:"POST",headers:{"Content-Type":"application/json",Authorization:"key=AAAA27BBYGI:APA91bFgaxvkq61FxnWArhOnPZHCUHnhZgBlInE4LC7RSS74MP7bl881fj6toBNpjmtTuRw973fy-txNhyl-rQJq8vEg3989Q0Q4hu8uRQ_MN8dcFSDbjgTJEDZuCZ-bcv12SDNpuu0a"},url:"https://fcm.googleapis.com/fcm/send",json:!0,body:s},function(e,n,a){t()})}}},function(e,t,n){e.exports={fetch:function(e,t,a){function s(e){if(0<e.length){var t=e.pop();i({url:t.link[0],jar:!0},function(a,i,c){var l,d,u,m,p=n(12).load(c);try{l={title:t.title[0],description:t.description[0],content:t.description[0],link:t.link[0],guid:t.guid[0],pubdate:t.pubDate[0],created_At:o(t.pubDate[0]),updated_At:new Date},a||(p(".article").each(function(e){0==e&&(d=p(this).find(".article-body>p").text(),u=p(this).find("picture>source").attr("srcset"))}),d?(l.content=d,l.headerimage=u):(m=p(".story-content-main>p").text())&&(l.content=m,l.headerimage=p(".story-content-main").find(".first-image>img").attr("src"))),new r(l).save(function(t,n){s(e)})}catch(e){}})}}var i=n(1),o=n(27),r=n(16).getModel(e),c=n(24).parseString;i({url:"http://www.espncricinfo.com/rss/content/story/feeds/0.xml",jar:!0},function(e,t,n){e?a({status:"error",result:{}}):c(n,function(e,t){e?a({status:"error",result:{}}):r.remove({}).exec(function(e,n){e?a({status:"error",result:{}}):(s(t.rss.channel[0].item),a({status:"success",result:t}))})})})}}},function(e,t){e.exports={service:{host:"http://localhost",port:80,apiversion:"v1",baseurl:"http://localhost"},database:{host:"localhost",port:27017,db:"cricketapp",username:"",password:""},email:{username:"support@clofus.com",password:"0182680c955d37f1ba707640aba9b0ed",from:"support@clofus.com",service:"mailgun",host:"smtp.mailgun.org",port:587,trackerimage:"/logo_tiny.png"},googlemaps:{key:"AIzaSyCAZS4vCDwjVZgs-COeAC0YQfJAZv8BQk4"}}},function(e,t,n){e.exports={initialize:function(){var e,t,a,s,i,o;if(n(13),e=n(0),t=n(5).getconfig(),a=n(32),t.database.replicaset){for(s="mongodb://"+t.database.username+":"+t.database.password+"@",i=t.database.replicaSets,o=0;o<i.nodes.length;o++)0<o&&o<i.nodes.length&&(s+=","),s=s+i.nodes[o].host+":"+i.nodes[o].port;s=s+"/"+t.database.db,s=s+"?"+a.stringify(i.options)}else s="mongodb://"+t.database.username+":"+t.database.password+"@"+t.database.host+"/"+t.database.db;return console.log("Connecting...",s),e.connect(s),n(8).registerModel(e),n(6).registerModel(e),n(21).registerModel(e),n(4).registerModel(e),n(15).registerModel(e),n(26).registerModel(e),n(2).registerModel(e),n(16).registerModel(e),n(22).registerModel(e),n(23).registerModel(e),n(9).registerModel(e),n(11).registerModel(e),n(3).registerModel(e),n(7).registerModel(e),e.connection.on("error",console.error.bind(console,"connection error")),e}}},function(e,t){e.exports=require("query-string")},function(e,t){e.exports=require("mongoose-paginate")},function(e,t){e.exports=require("nodemailer")},function(e,t){e.exports=require("bluebird")},function(e,t,n){e.exports={matches:function(e,t){function a(e){if(0<e.length){var t=e.pop();o(t.link[0],function(n,s,o){var u,m,p,_,f;if(!n){s=i.load(o),o=s(".game-details.header").text().split(" at "),u={},u.current_match_status=s(".game-time").text().toLowerCase(),n=1<o[0].split(",").length?o[0].split(",")[1]:o[0],m={team_name:s(".team-name.app_partial >.long-name").eq(0).text(),short_name:s(".team-name.app_partial >.short-name").eq(0).text(),alias:s(".team-name.app_partial >.abbrev").eq(0).text(),country:""},p={team_name:s(".team-name.app_partial >.long-name").eq(1).text(),short_name:s(".team-name.app_partial >.short-name").eq(1).text(),alias:s(".team-name.app_partial >.abbrev").eq(1).text(),country:""};try{-1<s(".game-details.header").text().split(" at ")[1].split(",")[1].indexOf("-")?u.match_type="test":u.match_type="limited_over"}catch(e){}try{_=s(".team-logo").eq(0).attr("data-src").split("&"),m.flag=0<_.length?_[0]+"?&w=200&h=200":_+"?&w=200&h=200",f=s(".team-logo").eq(3).attr("data-src").split("&"),p.flag=0<f.length?f[0]+"?&w=200&h=200":f+"?&w=200&h=200"}catch(e){}u.match_venue=s(".stadium-details>h4>a").attr("name"),u.match_details=o[0].split(",")[0],u.auto_match_link=t.link[0],u.auto_match_guid=t.guid[0],u.scoreupdate="auto",u.match_view_status="inactive",_=u.auto_match_guid.split("/"),0<_.length&&(u.auto_match_id=_[_.length-1].split(".")[0]),r.isvalidData(n)&&r.isvalidData(m.team_name)&&r.isvalidData(p.team_name)&&r.isvalidData(m.alias)&&r.isvalidData(p.alias)&&r.isvalidData(u.match_type)?l.findOneAndUpdate({tournament_name:n},{tournament_name:n,overs:0},{upsert:!0,new:!0},function(t,n){t?console.log("error in create tournament"):(u.tournament=n._id,c.findOneAndUpdate({team_name:m.team_name},m,{upsert:!0,new:!0},function(t,n){u.team_1={},u.team_1.teamid=n._id,u.team_1.status=!1,"on"==n.autofetch&&(u.match_view_status="active"),t||c.findOneAndUpdate({team_name:p.team_name},p,{upsert:!0,new:!0},function(t,n){t||(u.team_2={},u.team_2.teamid=n._id,u.team_2.status=!1,"on"==n.autofetch&&(u.match_view_status="active"),d.findOneAndUpdate({auto_match_id:u.auto_match_id},u,{upsert:!0,new:!0},function(t,n){t||a(e)}))})}))}):a(e)}})}}var s,i,o=n(1),r=n(17),c=n(6).getModel(e),l=n(7).getModel(e),d=n(2).getModel(e);n(3).getModel(e),n(11).getModel(e),n(4).getModel(e),n(10),s=n(24).parseString,i=n(12),o({url:"http://static.cricinfo.com/rss/livescores.xml",jar:!0},function(e,n,i){e?t({status:"error in fetch"}):s(i,function(e,n){0<n.rss.channel.length?(a(n.rss.channel[0].item),t({status:"success",results:n})):t({status:"no livescore found"})})})},scores:function(e,t){function a(e){if(0<e.length){var t=e.pop();"on"==t.team_1.teamid.autofetch||"on"==t.team_2.teamid.autofetch?c({url:t.auto_match_link,jar:!0},function(n,l,d){var u,m,p,_,f,y;n||(u=function(t){var n=JSON.parse(JSON.stringify(t));delete n.team_1.teamid,delete n.team_2.teamid,delete n.tournament,n.team_1.teamid=t.team_1.teamid._id,n.team_2.teamid=t.team_2.teamid._id,n.tournament=t.tournament._id,s.update({auto_match_id:t.auto_match_id},n,function(n,s){n?(c({url:"http://localhost:8000/api/v1/pushdata",qs:{match_id:t._id}},function(e,t,n){e&&console.log(e)}),a(e)):"live"==t.current_match_status?(new i(y).save(function(n,s){n||c({url:"http://localhost:8000/api/v1/pushdata",qs:{match_id:t._id}},function(e,t,n){e&&console.log(e)}),a(e)}),c({url:"http://localhost:8000/api/v1/pushdata",qs:{match_id:t._id}},function(e,t,n){e&&console.log(e)})):(c({url:"http://localhost:8000/api/v1/pushdata",qs:{match_id:t._id}},function(e,t,n){e&&console.log(e)}),a(e))})},n=function(e,t){c({url:t,jar:!0},function(t,n,a){var s,i,l=r.load(a);e.team_1.scorecard_auto=[],e.team_2.scorecard_auto=[],e.team_1.bowler_scorecard_auto=[],e.team_2.bowler_scorecard_auto=[],e.team_1.fall_of_wickets=[],e.team_2.fall_of_wickets=[],s=1,i=1,l(".sub-module.scorecard").each(function(t){var n,a,o,r;try{n=l(this).find("H2").text(),"test"==e.match_type&&(-1<n.indexOf("1st")?s=1:-1<n.indexOf("2nd")&&(s=2))}catch(e){}if(-1<n.indexOf(p.team_name)||-1<n.indexOf(p.short_name)||-1<n.indexOf(p.alias)){try{m(t,"team1",e),a=l(this).find(".flex-row>.wrap.header>.cell.runs").eq(1).text(),l(this).find(".flex-row>.wrap.batsmen").each(function(){var t={innings:s,player_id:Math.floor(2*Math.random())+1e6,player_name:l(this).find(".cell.batsmen").text(),score:l(this).find(".cell.runs").eq(0).text(),wicket_notes:l(this).find(".cell.commentary").text()};"M"==a?(t.balls=l(this).find(".cell.runs").eq(2).text(),t.fours=l(this).find(".cell.runs").eq(3).text(),t.sixes=l(this).find(".cell.runs").eq(4).text(),t.strike_rate=l(this).find(".cell.runs").eq(5).text()):(t.balls=l(this).find(".cell.runs").eq(1).text(),t.fours=l(this).find(".cell.runs").eq(2).text(),t.sixes=l(this).find(".cell.runs").eq(3).text(),t.strike_rate=l(this).find(".cell.runs").eq(4).text()),t.wicket="not out"!=t.wicket_notes&&"retired hurt"!=t.wicket_notes?1:0,"not out"==t.wicket_notes&&(t.playing=!0),e.team_1.scorecard_auto.push(t)})}catch(e){}try{l(this).find(".flex-row>.wrap.dnb>.cell").each(function(){-1<l(this).find("span").text().indexOf("wicket")&&null!=l(this).text()&&l(this).text().split(":")[1].split("),").forEach(function(t){t={innings:s,player_name:t.split("(")[1].split(",")[0],overs:t.split("(")[1].split(",")[1].replace(" ","").split(" ")[0].split(".")[0],balls:t.split("(")[1].split(",")[1].replace(" ","").split(" ")[0].split(".")[1],wicket_position:t.split("(")[0].split(" ").join("").split("-")[0],score:t.split("(")[0].split(" ").join("").split("-")[1]},e.team_1.fall_of_wickets.push(t)})})}catch(e){}try{l(this).find(".scorecard-section.bowling tbody tr").each(function(t,n){t={innings:s,player_name:l(this).find("td").eq(0).text(),overs:l(this).find("td").eq(2).text(),maiden:l(this).find("td").eq(3).text(),runs:l(this).find("td").eq(4).text(),numberofwickets:l(this).find("td").eq(5).text(),economy:l(this).find("td").eq(6).text(),dots:l(this).find("td").eq(7).text(),fours:l(this).find("td").eq(8).text(),sixes:l(this).find("td").eq(9).text(),wide:l(this).find("td").eq(10).text(),noball:l(this).find("td").eq(11).text()},void 0!==t.overs&&null!=t.overs&&(t.balls=6*parseInt(t.overs.split(".")[0])+parseInt(t.overs.split(".")[1])),e.team_1.bowler_scorecard_auto.push(t)})}catch(e){}if(n=l(this).find(".wrap.total > .cell").eq(1).text(),o=l(this).find(".flex-row>.wrap.extras>.cell").eq(1).text(),1==s){try{-1<n.indexOf("all out")?(e.team_1.scores=n.split("(")[0].replace(" all out ",""),e.team_1.wickets=10):(e.team_1.scores=n.split("(")[0].split("/")[0],e.team_1.wickets=n.split("(")[0].split("/")[1]),e.team_1.overs=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[0],1<n.split("(")[1].split(",")[0].split(" ")[0].split(".").length?e.team_1.balls=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[1]:e.team_1.balls=0}catch(e){}try{r=o.split(" (")[1].replace(")","").split(","),void 0!==r&&(e.team_1.byes=0,e.team_1.legbyes=0,e.team_1.wide=0,e.team_1.noball=0,r.forEach(function(t,n){0!=n&&(t=t.replace(" ","")),n=t.split(" ")[0],t=t.split(" ")[1],"b"==n&&(e.team_1.byes=t),"lb"==n&&(e.team_1.legbyes=t),"w"==n&&(e.team_1.wide=t),"nb"==n&&(e.team_1.noball=t)}))}catch(e){}try{e.team_1.runrate=n.split("(")[1].split(",")[1].replace(")","").replace("RR: ","").replace(" ","")}catch(e){}}else if(2==s){try{-1<n.indexOf("all out")?(e.team_1.second_innings_scores=n.split("(")[0].replace(" all out ",""),e.team_1.second_innings_wickets=10):(e.team_1.second_innings_scores=n.split("(")[0].split("/")[0],e.team_1.second_innings_wickets=n.split("(")[0].split("/")[1]),e.team_1.second_innings_overs=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[0],1<n.split("(")[1].split(",")[0].split(" ")[0].split(".").length?e.team_1.second_innings_balls=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[1]:e.team_1.second_innings_balls=0}catch(e){}try{void 0!==(r=o.split(" (")[1].replace(")","").split(","))&&(e.team_1.second_innings_byes=0,e.team_1.second_innings_legbyes=0,e.team_1.second_innings_wide=0,e.team_1.second_innings_noball=0,r.forEach(function(t,n){0!=n&&(t=t.replace(" ","")),n=t.split(" ")[0],t=t.split(" ")[1],"b"==n&&(e.team_1.second_innings_byes=t),"lb"==n&&(e.team_1.second_innings_legbyes=t),"w"==n&&(e.team_1.second_innings_wide=t),"nb"==n&&(e.team_1.second_innings_noball=t)}))}catch(e){}try{e.team_1.runrate=n.split("(")[1].split(",")[1].replace(")","").replace("RR: ","").replace(" ","")}catch(e){}}}else if(-1<n.indexOf(_.team_name)||-1<n.indexOf(_.short_name)||-1<n.indexOf(_.alias)){a=l(this).find(".flex-row>.wrap.header>.cell.runs").eq(1).text(),"test"==e.match_type&&(-1<n.indexOf("1st")?i=1:-1<n.indexOf("2nd")&&(i=2));try{l(this).find(".flex-row>.wrap.batsmen").each(function(){m(t,"team2",e);var n={innings:i,player_id:Math.floor(2*Math.random())+1e6,player_name:l(this).find(".cell.batsmen").text(),score:l(this).find(".cell.runs").eq(0).text(),wicket_notes:l(this).find(".cell.commentary").text()};"M"==a?(n.balls=l(this).find(".cell.runs").eq(2).text(),n.fours=l(this).find(".cell.runs").eq(3).text(),n.sixes=l(this).find(".cell.runs").eq(4).text(),n.strike_rate=l(this).find(".cell.runs").eq(5).text()):(n.balls=l(this).find(".cell.runs").eq(1).text(),n.fours=l(this).find(".cell.runs").eq(2).text(),n.sixes=l(this).find(".cell.runs").eq(3).text(),n.strike_rate=l(this).find(".cell.runs").eq(4).text()),n.wicket="not out"!=n.wicket_notes&&"retired hurt"!=n.wicket_notes?1:0,"not out"==n.wicket_notes&&(n.playing=!0),e.team_2.scorecard_auto.push(n)})}catch(e){}try{l(this).find(".flex-row>.wrap.dnb>.cell").each(function(){-1<l(this).find("span").text().indexOf("wicket")&&null!=l(this).text()&&l(this).text().split(":")[1].split("),").forEach(function(t){t={innings:i,player_name:t.split("(")[1].split(",")[0],overs:t.split("(")[1].split(",")[1].replace(" ","").split(" ")[0].split(".")[0],balls:t.split("(")[1].split(",")[1].replace(" ","").split(" ")[0].split(".")[1],wicket_position:t.split("(")[0].split(" ").join("").split("-")[0],score:t.split("(")[0].split(" ").join("").split("-")[1]},e.team_2.fall_of_wickets.push(t)})})}catch(e){}try{l(this).find(".scorecard-section.bowling tbody tr").each(function(t,n){t={innings:i,player_name:l(this).find("td").eq(0).text(),overs:l(this).find("td").eq(2).text(),maiden:l(this).find("td").eq(3).text(),runs:l(this).find("td").eq(4).text(),numberofwickets:l(this).find("td").eq(5).text(),economy:l(this).find("td").eq(6).text(),dots:l(this).find("td").eq(7).text(),fours:l(this).find("td").eq(8).text(),sixes:l(this).find("td").eq(9).text(),wide:l(this).find("td").eq(10).text(),noball:l(this).find("td").eq(11).text()},void 0!==t.overs&&null!=t.overs&&(t.balls=6*parseInt(t.overs.split(".")[0])+parseInt(t.overs.split(".")[1])),e.team_2.bowler_scorecard_auto.push(t)})}catch(e){}if(n=l(this).find(".wrap.total > .cell").eq(1).text(),o=l(this).find(".flex-row>.wrap.extras>.cell").eq(1).text(),1==i){try{-1<n.indexOf("all out")?(e.team_2.scores=n.split("(")[0].replace(" all out ",""),e.team_2.wickets=10):(e.team_2.scores=n.split("(")[0].split("/")[0],e.team_2.wickets=n.split("(")[0].split("/")[1])}catch(e){}try{e.team_2.overs=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[0],1<n.split("(")[1].split(",")[0].split(" ")[0].split(".").length?e.team_2.balls=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[1]:e.team_2.balls=0}catch(e){}try{void 0!==(r=o.split(" (")[1].replace(")","").split(","))&&(e.team_2.byes=0,e.team_2.legbyes=0,e.team_2.wide=0,e.team_2.noball=0,r.forEach(function(t,n){0!=n&&(t=t.replace(" ","")),n=t.split(" ")[0],t=t.split(" ")[1],"b"==n&&(e.team_2.byes=t),"lb"==n&&(e.team_2.legbyes=t),"w"==n&&(e.team_2.wide=t),"nb"==n&&(e.team_2.noball=t)}))}catch(e){}try{e.team_2.runrate=n.split("(")[1].split(",")[1].replace(")","").replace("RR: ","").replace(" ","")}catch(e){}}else if(2==i){try{-1<n.indexOf("all out")?(e.team_2.second_innings_scores=n.split("(")[0].replace(" all out ",""),e.team_2.second_innings_wickets=10):(e.team_2.second_innings_scores=n.split("(")[0].split("/")[0],e.team_2.second_innings_wickets=n.split("(")[0].split("/")[1])}catch(e){}try{e.team_2.second_innings_overs=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[0],1<n.split("(")[1].split(",")[0].split(" ")[0].split(".").length?e.team_2.second_innings_balls=n.split("(")[1].split(",")[0].split(" ")[0].split(".")[1]:e.team_2.second_innings_balls=0}catch(e){}try{void 0!==(r=o.split(" (")[1].replace(")","").split(","))&&(e.team_2.second_innings_byes=0,e.team_2.second_innings_legbyes=0,e.team_2.second_innings_wide=0,e.team_2.second_innings_noball=0,r.forEach(function(t,n){0!=n&&(t=t.replace(" ","")),n=t.split(" ")[0],t=t.split(" ")[1],"b"==n&&(e.team_2.second_innings_byes=t),"lb"==n&&(e.team_2.second_innings_legbyes=t),"w"==n&&(e.team_2.second_innings_wide=t),"nb"==n&&(e.team_2.second_innings_noball=t)}))}catch(e){}try{e.team_2.runrate=n.split("(")[1].split(",")[1].replace(")","").replace("RR: ","").replace(" ","")}catch(e){}}}}),"result"==e.current_match_status&&(e.status=l(".game-status").eq(1).text()),"live"==e.current_match_status?c({url:e.auto_match_link,jar:!0},function(t,n,a){var s,i=r.load(a);if(-1<f.indexOf(p.team_name.toLowerCase())||-1<f.indexOf(p.short_name.toLowerCase())||-1<f.indexOf(p.alias.toLowerCase())){try{y.team=p._id,y.overs=e.team_1.overs,y.balls=e.team_1.balls,e.team_1.status=!0,i(".commentary-item").each(function(){var t=i(this).find(".over > .time-stamp").text().split(".")[0],n=i(this).find(".over > .time-stamp").text().split(".")[1],a=i(this).find(".over > .over-circle").text(),s=i(this).find(".description").text();void 0!==n&&void 0!==a&&o.findOneAndUpdate({match_id:e._id,ball:n,over:t,team:"team1"},{match_id:e._id,ball:n,over:t,team:"team1",created_At:new Date,text:s},{upsert:!0,new:!0},function(e,t){}),6==n&&(t=parseInt(t)+1,n=0),t==e.team_1.overs&&n==e.team_1.balls&&(y.event={},"0"==a&&(y.event.dot=0),"1"==a&&(y.event.one=1),"2"==a&&(y.event.two=2),"3"==a&&(y.event.three=3),"4"==a&&(y.event.four=4),"6"==a&&(y.event.six=6),"W"==a&&(y.event.wicket=1),-1<a.indexOf("w")&&(y.event.wide=1))})}catch(e){}try{y.batsman_id=[],i(".sub-module.current-inning table>tbody").eq(0).each(function(){i(this).find("tr").each(function(){var t,n=i(this).find("td").eq(0).text();for(-1<n.indexOf("*")&&(t=i(this).find("td").eq(0).text(),y.active_batsman={player_name:t,runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""}),t=0;t<e.team_1.scorecard_auto.length;t++)-1<e.team_1.scorecard_auto[t].player_name.indexOf(n.replace("*",""))&&(e.team_1.scorecard_auto[t].striker_end_batsman=!0);y.batsman_id.push({player_name:i(this).find("td").eq(0).text(),runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""})})})}catch(e){}try{for(i(".sub-module.current-inning table>tbody").eq(1).find("tr").each(function(e){if(0==e){y.active_bowler={};var t=i(this).find("td").eq(0).text().split("(");y.active_bowler.player_name=0<t.length?t[0]:t,y.active_bowler.age="",y.active_bowler.type="",y.active_bowler.overs=i(this).find("td").eq(1).text(),y.active_bowler.maiden=i(this).find("td").eq(2).text(),y.active_bowler.runs=i(this).find("td").eq(3).text(),y.active_bowler.wicket=i(this).find("td").eq(4).text()}1==e&&0!=parseInt(i(this).find("td").eq(1).text().split(".")[1])&&(y.active_bowler={},t=i(this).find("td").eq(0).text().split("("),y.active_bowler.player_name=0<t.length?t[0]:t,y.active_bowler.age="",y.active_bowler.type="",y.active_bowler.overs=i(this).find("td").eq(1).text(),y.active_bowler.maiden=i(this).find("td").eq(2).text(),y.active_bowler.runs=i(this).find("td").eq(3).text(),y.active_bowler.wicket=i(this).find("td").eq(4).text())}),s=0;s<e.team_1.bowler_scorecard_auto.length;s++)-1<e.team_1.bowler_scorecard_auto[s].player_name.indexOf(y.active_bowler.player_name.replace("*",""))&&(e.team_1.bowler_scorecard_auto[s].playing=!0)}catch(e){}try{i(".sub-module.current-inning table>tbody").eq(1).each(function(){i(this).find("tr").each(function(){-1<i(this).find("td").eq(0).text().indexOf("*")&&(y.active_batsman={player_name:i(this).find("td").eq(0).text(),runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""}),y.batsman_id.push({player_name:i(this).find("td").eq(0).text(),runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""})})})}catch(e){}}if(-1<f.indexOf(_.team_name.toLowerCase())||-1<f.indexOf(_.short_name.toLowerCase())||-1<f.indexOf(_.alias.toLowerCase())){try{y.team=_._id,y.overs=e.team_2.overs,y.balls=e.team_2.balls,e.team_2.status=!0,i(".commentary-item").each(function(){var t=i(this).find(".over > .time-stamp").text().split(".")[0],n=i(this).find(".over > .time-stamp").text().split(".")[1],a=i(this).find(".over > .over-circle").text(),s=i(this).find(".description").text();void 0!==n&&void 0!==a&&o.findOneAndUpdate({match_id:e._id,ball:n,over:t,team:"team2"},{match_id:e._id,ball:n,over:t,created_At:new Date,team:"team2",text:s},{upsert:!0,new:!0},function(e,t){}),6==n&&(t=parseInt(t)+1,n=0),t==e.team_2.overs&&n==e.team_2.balls&&(y.event={},"0"==a&&(y.event.dot=0),"1"==a&&(y.event.one=1),"2"==a&&(y.event.two=2),"3"==a&&(y.event.three=3),"4"==a&&(y.event.four=4),"6"==a&&(y.event.six=6),"W"==a&&(y.event.wicket=1),-1<a.indexOf("w")&&(y.event.wide=1))})}catch(e){}try{y.batsman_id=[],i(".sub-module.current-inning table>tbody").eq(0).each(function(){i(this).find("tr").each(function(){var t,n=i(this).find("td").eq(0).text();for(-1<n.indexOf("*")&&(t=i(this).find("td").eq(0).text(),y.active_batsman={player_name:t,runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""}),t=0;t<e.team_2.scorecard_auto.length;t++)-1<e.team_2.scorecard_auto[t].player_name.indexOf(n.replace("*",""))&&(e.team_2.scorecard_auto[t].striker_end_batsman=!0);y.batsman_id.push({player_name:i(this).find("td").eq(0).text(),runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""})})})}catch(e){}try{for(i(".sub-module.current-inning table>tbody").eq(1).find("tr").each(function(e){if(0==e){y.active_bowler={};var t=i(this).find("td").eq(0).text().split("(");y.active_bowler.player_name=0<t.length?t[0]:t,y.active_bowler.age="",y.active_bowler.type="",y.active_bowler.overs=i(this).find("td").eq(1).text(),y.active_bowler.maiden=i(this).find("td").eq(2).text(),y.active_bowler.runs=i(this).find("td").eq(3).text(),y.active_bowler.wicket=i(this).find("td").eq(4).text()}1==e&&0!=parseInt(i(this).find("td").eq(1).text().split(".")[1])&&(y.active_bowler={},t=i(this).find("td").eq(0).text().split("("),y.active_bowler.player_name=0<t.length?t[0]:t,y.active_bowler.age="",y.active_bowler.type="",y.active_bowler.overs=i(this).find("td").eq(1).text(),y.active_bowler.maiden=i(this).find("td").eq(2).text(),y.active_bowler.runs=i(this).find("td").eq(3).text(),y.active_bowler.wicket=i(this).find("td").eq(4).text())}),s=0;s<e.team_2.bowler_scorecard_auto.length;s++)-1<e.team_2.bowler_scorecard_auto[s].player_name.indexOf(y.active_bowler.player_name.replace("*",""))&&(e.team_2.bowler_scorecard_auto[s].playing=!0)}catch(e){}try{i(".sub-module.current-inning table>tbody").eq(1).each(function(){i(this).find("tr").each(function(){-1<i(this).find("td").eq(0).text().indexOf("*")&&(y.active_batsman={player_name:i(this).find("td").eq(0).text(),runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""}),y.batsman_id.push({player_name:i(this).find("td").eq(0).text(),runs:i(this).find("td").eq(1).text(),balls:i(this).find("td").eq(2).text(),fours:i(this).find("td").eq(3).text(),sixes:i(this).find("td").eq(4).text(),strike_rate:i(this).find("td").eq(5).text(),age:0,type:""})})})}catch(e){}}u(e)}):"result"==e.current_match_status?(e.team_1.battingcompleted=!0,e.team_2.battingcompleted=!0,t="http://www.espncricinfo.com"+l(".first-group>.sub>.game.react-router-link").attr("href"),"live"==l(".first-group>.sub>.game.react-router-link>.link-text").text().toLowerCase()?c({url:t,jar:!0},function(t,n,a){var s=r.load(a);try{s(".sub-module.current-inning table>tbody").eq(0).each(function(){s(this).find("tr").each(function(){for(var t=s(this).find("td").eq(0).text(),n=0;n<e.team_1.scorecard_auto.length;n++)-1<e.team_1.scorecard_auto[n].player_name.indexOf(t)&&(e.team_1.scorecard_auto[n].playing=!0);for(n=0;n<e.team_2.scorecard_auto.length;n++)-1<e.team_2.scorecard_auto[n].player_name.indexOf(t)&&(e.team_2.scorecard_auto[n].playing=!0)})})}catch(e){}try{s(".sub-module.scorecard-summary>.content>.inning>.two-col-table").eq(2).each(function(){s(this).find("li>a").eq(0).text().replace("*",""),s(this).find("li>a").eq(1).text().replace("*","")})}catch(e){}try{s(".sub-module.current-inning table>tbody").eq(1).find("tr").each(function(t){if(0==t){t=s(this).find("td").eq(0).text().split("(");var n=0<t.length?t[0]:t;for(t=0;t<e.team_1.bowler_scorecard_auto.length;t++)-1<e.team_1.bowler_scorecard_auto[t].player_name.indexOf(n)&&(e.team_1.bowler_scorecard_auto[t].playing=!0);for(t=0;t<e.team_2.bowler_scorecard_auto.length;t++)-1<e.team_2.bowler_scorecard_auto[t].player_name.indexOf(n)&&(e.team_2.bowler_scorecard_auto[t].playing=!0)}if(1==t){for(t=s(this).find("td").eq(0).text().split("("),n=0<t.length?t[0]:t,t=0;t<e.team_1.bowler_scorecard_auto.length;t++)-1<e.team_1.bowler_scorecard_auto[t].player_name.indexOf(n)&&(e.team_1.bowler_scorecard_auto[t].playing=!0);for(t=0;t<e.team_2.bowler_scorecard_auto.length;t++)-1<e.team_2.bowler_scorecard_auto[t].player_name.indexOf(n)&&(e.team_2.bowler_scorecard_auto[t].playing=!0)}})}catch(e){}u(e)}):c({url:t,jar:!0},function(t,n,a){var s=r.load(a);try{s(".sub-module.scorecard-summary>.content>.inning>.two-col-table").eq(2).each(function(){for(var t=s(this).find("li>a").eq(0).text().replace("*",""),n=s(this).find("li>a").eq(1).text().replace("*",""),a=0;a<e.team_1.scorecard_auto.length;a++)(-1<e.team_1.scorecard_auto[a].player_name.indexOf(t)||-1<e.team_1.scorecard_auto[a].player_name.indexOf(n))&&(e.team_1.scorecard_auto[a].playing=!0);for(a=0;a<e.team_2.scorecard_auto.length;a++)(-1<e.team_2.scorecard_auto[a].player_name.indexOf(t)||-1<e.team_2.scorecard_auto[a].player_name.indexOf(n))&&(e.team_2.scorecard_auto[a].playing=!0)})}catch(e){}try{s(".sub-module.scorecard-summary>.content>.inning>.two-col-table").eq(3).each(function(){for(var t=s(this).find("li>a").eq(0).text().replace("*",""),n=s(this).find("li>a").eq(1).text().replace("*",""),a=0;a<e.team_1.bowler_scorecard_auto.length;a++)(-1<e.team_1.bowler_scorecard_auto[a].player_name.indexOf(t)||-1<e.team_1.bowler_scorecard_auto[a].player_name.indexOf(n))&&(e.team_1.bowler_scorecard_auto[a].playing=!0);for(a=0;a<e.team_2.bowler_scorecard_auto.length;a++)(-1<e.team_2.bowler_scorecard_auto[a].player_name.indexOf(t)||-1<e.team_2.bowler_scorecard_auto[a].player_name.indexOf(n))&&(e.team_2.bowler_scorecard_auto[a].playing=!0)})}catch(e){}u(e)})):u(e)})},m=function(e,t,n){0==e?(n.innings.first=t,n.innings.current=1):1==e?("limited_over"==n.match_type&&("team1"==n.innings.first?(n.team_2.targetscore=n.team_1.scores,n.team_2.totalovers=n.team_1.overs,n.team_1.battingcompleted=!0):(n.team_1.targetscore=n.team_2.scores,n.team_1.totalovers=n.team_2.overs,n.team_2.battingcompleted=!0)),n.innings.second=t,n.innings.current=2):2==e?(n.innings.third=t,n.innings.current=3):3==e&&(n.innings.fourth=t,n.innings.current=4)},d=r.load(d),l=d(".match-detail-container >.match-detail--item>.match-detail--right").eq(1).text(),p=t.team_1.teamid,_=t.team_2.teamid,f=d(".sub-module.current-inning").find("header > h1").text().toLowerCase(),y={},y.match_id=t._id,t.current_match_status=d(".game-time").text().toLowerCase(),t.match_view_status="active",-1<l.indexOf("elected")&&(-1<l.indexOf(p.team_name)||-1<l.indexOf(p.short_name)||-1<l.indexOf(p.alias)?(t.team_1.toss=!0,t.team_2.toss=!1):(-1<l.indexOf(_.team_name)||-1<l.indexOf(_.short_name)||-1<l.indexOf(_.alias))&&(t.team_1.toss=!1,t.team_2.toss=!0)),"live"==t.current_match_status&&(-1<f.indexOf(p.team_name)&&(t.team_1.teamid.status=!0,t.team_2.teamid.status=!1),-1<f.indexOf(_.team_name)&&(t.team_1.teamid.status=!1,t.team_2.teamid.status=!0),t.innings={}),void 0!==d(".first-group>.sub>.scorecard.react-router-link").attr("href")?(d="http://www.espncricinfo.com"+d(".first-group>.sub>.scorecard.react-router-link").attr("href"),n(t,d)):u(t))}):a(e)}}var s,i,o,r,c=n(1);n(17),n(6).getModel(e),n(7).getModel(e),s=n(2).getModel(e),n(3).getModel(e),i=n(3).getModel(e),o=n(4).getModel(e),n(10),r=n(12),s.find({scoreupdate:"auto"}).populate("team_1.teamid").populate("team_2.teamid").populate("tournament").exec(function(e,n){e?t({status:"error"}):(e=JSON.parse(JSON.stringify(n)),a(e),t({status:"success",data:n}))})}}},function(e,t){e.exports=require("crypto-js")},function(e,t,n){e.exports={sendMail:function(e){var t=n(34),a=n(39),s=n(5);t.createTransport(a({host:s.email.host,port:s.email.port,auth:{user:s.email.uname,pass:s.email.pwd}})).sendMail(e,function(e,t){e&&console.log(e),console.log("Message sent: ",t)})}}},function(e,t){e.exports=require("nodemailer-smtp-transport")},function(e,t){e.exports=require("gridfs-stream")},function(e,t){e.exports=require("multer")},function(e,t,n){var a,s,i,o,r;e=n(25),t=n(43),n(44),n(13),a=n(45),s=n(5).getconfig(),i=n(31).initialize(),o=e(),a=a.createServer(o),r=n(46).init(a),o.set("socketio",r),r=n(48),o.use(r(12e4)),o.use(t.json()),o.use(t.urlencoded({extended:!1})),o.use(n(49)),o.use(n(50)),o.use(function(e,t,n){t.setTimeout(48e4,function(){console.log("Request has timed out."),t.send(408)}),n()}),o.use("/api/"+s.service.apiversion+"/account",n(51)(e,i)),o.use("/api/"+s.service.apiversion+"/activeteams",n(58)(e,i)),o.use("/api/"+s.service.apiversion+"/api",n(59)(e,i)),o.use("/api/"+s.service.apiversion+"/autogenerate",n(60)(e,i)),o.use("/api/"+s.service.apiversion+"/commentary",n(61)(e,i)),o.use("/api/"+s.service.apiversion+"/email",n(62)(e,i)),o.use("/api/"+s.service.apiversion+"/file",n(65)(e,i)),o.use("/api/"+s.service.apiversion+"/gifs",n(66)(e,i)),o.use("/api/"+s.service.apiversion+"/matchlists",n(67)(e,i)),o.use("/api/"+s.service.apiversion+"/newsfeed",n(68)(e,i)),o.use("/api/"+s.service.apiversion+"/players",n(69)(e,i)),o.use("/api/"+s.service.apiversion+"/pushdata",n(70)(e,i)),o.use("/api/"+s.service.apiversion+"/scores",n(71)(e,i)),o.use("/api/"+s.service.apiversion+"/tournaments",n(72)(e,i)),o.get("/",function(e,t){t.send("Hello World!")}),o.set("port",s.service.port||8080),a.listen(o.get("port"),"0.0.0.0",function(){console.log("Server listening at port %d",o.get("port"))})},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("http")},function(e,t,n){e.exports={getconnection:function(){},init:function(e){return e=n(47)(e),e.on("connection",function(e){var t=!1,n=0;e.on("add user",function(a){console.log("add user called"),console.log(a),t?console.log("user already addded so skip"):(console.log("new user so add"),e.username=a,++n,t=!0,e.emit("login",{numUsers:n}))})}),e}}},function(e,t){e.exports=require("socket.io")},function(e,t){e.exports=require("connect-timeout")},function(e,t,n){t=n(25).Router(),t.use(function(e,t,n){t.setHeader("Last-Modified",(new Date).toUTCString()),t.header("Cache-Control","no-cache, no-store, must-revalidate"),t.header("Pragma","no-cache"),t.header("Expires",0),t.setHeader("Access-Control-Allow-Methods","GET,PUT,POST,DELETE"),t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Headers","X-Requested-With, X-HTTP-Method-Override, Content-Type, Accept, Authorization, refresh_token, grant_type, enctype, client_id"),n()}),e.exports=t},function(e,t,n){e.exports=function(e,t,a){n(25),n(27);var s=n(5).getconfig(),i=n(22).getModel(),o=n(8).getModel(),r=e.headers.authorization;if(route=e.url,-1==route.indexOf("/api/")||-1<route.indexOf("/api/"+s.service.apiversion+"/file"))a();else if(-1<route.indexOf("/account/login")||-1<route.indexOf("/account")||-1<route.indexOf("/account/confirmEmail")||-1<route.indexOf("/matchlists/getmatchdetails")||-1<route.indexOf("/account/forgotPassword")||-1<route.indexOf("/account/resetPassword")||-1<route.indexOf("/gifs")||-1<route.indexOf("/pushdata")||-1<route.indexOf("/matchlists/scorelist")||-1<route.indexOf("/autogenerate/matches")||-1<route.indexOf("/autogenerate/scores")||-1<route.indexOf("/newsfeed/create")||-1<route.indexOf("/newsfeed/latest"))e.query.userrole="admin",a();else{if(!r)return console.log("Session invalid"),t.send([{status:"Session invalid"}]);i.findOne({token:r}).exec().then(function(n){if(!n)return console.log("Invalid access token"),t.send([{status:"Invalid access token"}]);i.update({_id:n._id},{session:new Date}).exec(),o.findOne({_id:n.user_id}).exec().then(function(t){t&&(e.query.userid=n.user_id,e.query.userrole=t.role,a())})})}}},function(e,t,n){e.exports=function(e,t){e=n(25),e=e.Router();var a=n(52),s=n(53),i=n(8).getModel(t),o=n(22).getModel(t);return e.post("/",function(e,t){s.register(e.body).then(function(e){return t.status(200).send({code:1,status:"success"})},function(e){return t.status(200).send({code:0,status:e.message})})}),e.post("/login",function(e,t){i.findOne({$or:[{username:e.body.username},{email:e.body.email}],password:e.body.password}).exec().then(function(n){if(!n)return t.status(401).send({error:{message:"User not found"}});if(n.password!=e.body.password)t.status(401).send({error:{message:"Wrong password"}});else if(n.emailToken)t.status(401).send({error:{message:"You must activate your email",code:40987,email:n.email}});else if("block"==n.status)t.status(401).send({error:{message:"Your account has been blocked. Contact our support team for more details.",code:40987,email:n.email}});else{var s;o.findOne({user_id:n._id}).exec().then(function(e){if(e){s=a.generateToken();var i={token:s,session:new Date};o.update({user_id:n._id},i).exec().then(function(e){if(1==e.ok)return t.status(200).send({status:"authenticated",token:i.token,userid:n});t.json({status:"invalid_user"})})}else s=a.generateToken(),i={user_id:n._id,token:s,session:new Date},new o(i).save(function(e,a){if(!e)return t.status(200).send({status:"authenticated",token:i.token,userid:n});t.json({status:"invalid_user"})})})}})}),e.post("/confirmEmail",function(e,t){s.confirmEmail(e.body.token).then(function(e){return t.send({success:!0})},function(e){return t.send({success:!1,error:{message:e.message,code:20938}})})}),e.post("/resetPassword",function(e,t){s.resetPassword(e.body).then(function(e){return t.send(200)},function(e){return t.send({error:{message:e.message,code:20938}})})}),e.post("/forgotPassword",function(e,t){if(!e.body.email)return t.send({error:{message:"Invalid Parameter"}});s.forgotPassword({email:e.body.email}).then(function(e){return t.send(200)},function(e){return t.send({error:{message:e.message,code:20938}})})}),e.post("/changepwd/:id",function(e,t){var n={};n=e.body,i.findOne({_id:e.params.id}).exec(function(a,s){a?t.send({status:"invalid_user",message:"User not found"}):(n.current===s.password?i.update({_id:e.params.id},{password:n.confirmpwd}).exec().then(function(e){return t.send({success:!0})}):t.send({status:"invalid_password",message:"Incorrect Old Password"}),t.send({status:"success",data:s}))})}),e.get("/referral/:id",function(e,t){e.params.id&&i.find({sponsor:e.params.id}).exec(function(e,n){e?t.send({status:"error"}):t.send({status:"success",data:n})})}),e.get("/search",function(e,t){i.find({$or:[{username:{$regex:e.query.key,$options:"i"}},{email:{$regex:e.query.key,$options:"i"}}],$and:[{username:{$ne:"admin"}}]}).exec(function(e,n){e?t.send({status:"error"}):t.send({status:"success",data:n})})}),e.get("/list",function(e,t){i.find({}).exec(function(e,n){e?t.send({status:"error"}):t.send({status:"success",data:n})})}),e.get("/",function(e,t){i.find().exec(function(e,n){e?t.send(e):t.send(n)})}),e.post("/update/:id",function(e,t){"admin"==e.query.userrole?i.findOne({_id:e.params.id},function(n,a){i.update({_id:e.params.id},e.body).exec().then(function(e){1==e.ok?t.json({status:"success"}):t.json({status:"failed"})})}):t.json({status:"access_denied"})}),e.delete("/update/:id",function(e,t){"admin"==e.query.userrole?i.find({_id:e.params.id}).remove().exec(function(e,n){e?t.send({status:"error"}):t.send({status:"success"})}):t.json({status:"access_denied"})}),e.post("/createuser",function(e,t){new i(e.body).save(function(e,n){e?t.send(e):t.send({result:"success"})})}),e.post("/sociallogin",function(e,t){var n={socialtype:e.body.socialtype,socialid:e.body.socialid};void 0!==e.body.socialtype&&void 0!==e.body.socialid?i.findOne(n).exec().then(function(n){if(n){var s={token:a.generateToken(),session:new Date};o.update({user_id:n._id},s,{upsert:!0}).exec().then(function(e){if(1==e.ok)return t.status(200).send({status:"authenticated",token:s.token,userid:n});t.json({status:"invalid_user"})})}else new i({social_name:e.body.social_name,socialtype:e.body.socialtype,socialid:e.body.socialid,social_token:e.body.social_token}).save(function(e,n){if(e)t.send(e);else{e=a.generateToken();var s={user_id:n._id,token:e,session:new Date};new o(s).save(function(e,a){if(!e)return t.status(200).send({status:"authenticated",token:s.token,userid:n});t.json({status:"invalid_user"})})}})}):t.json({status:"invalid_user"})}),e.delete("/deleteuser",function(e,t){i.deleteOne({_id:e.query.id}).exec(function(e,n){e?t.send(e):t.send({results:"success"})})}),e.get("/edituser/:id",function(e,t){i.find({_id:e.params.id}).exec(function(e,n){e?t.send(e):t.send(n)})}),e.put("/updateuser",function(e,t){i.findOneAndUpdate({_id:e.body._id},e.body).exec(function(e,n){e?t.send(e):t.send(n)})}),e}},function(e,t){function n(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}e.exports={generateToken:function(){return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},generatePassword:function(){return n()+n()+n()}}},function(e,t,n){e.exports={confirmEmail:n(54),forgotPassword:n(55),resetPassword:n(56),register:n(57)}},function(e,t,n){e.exports=function(e){var t=n(8).getModel();return t.findOne({emailToken:e}).exec().then(function(n){if(console.log(n),n)return t.update({emailToken:e},{$set:{emailToken:null,status:"active"}}).exec();throw Error("TokenNotFound")})}},function(e,t,n){var a=n(38),s=n(35),i=n(5).getconfig(),o=n(14);e.exports=function(e){return n(8).getModel().findOne({email:e.email}).exec().then(function(e){if(e)return e.fpToken=o.randomBytes(64).toString("hex"),new s(function(t,n){e.save(function(a){return a?n(a):t(e)})});throw Error("UserNotFound")}).then(function(e){return a.sendMail({from:"FundingPort<"+i.email.from+">",to:e.email,subject:"Reset Password",html:'<p style="margin-top:0;color:#74787e;font-size:16px;line-height:1.5em">You are receiving this email because we received a password reset request for your account.</p><p style="margin-top:0;color:#74787e;font-size:16px;line-height:1.5em">If this is you, please click this <a href="'+i.host+"/resetpwd?token="+e.fpToken+'"> link </a> to reset the password. </p><p style="margin-top:0;color:#74787e;font-size:16px;line-height:1.5em">If you did not request a password reset, no further action is required.</p>'}),e})}},function(e,t,n){var a=n(35);e.exports=function(e){var t=n(8).getModel();return actions={findUser:function(){return t.findOne({fpToken:e.token,email:e.email}).exec()},changePassword:function(n){if(n)return n.password=t.encryptPassword(e.password),n.fpToken=null,n.emailToken=null,n.status="active",new a(function(e,t){n.save(function(a){return a?t(a):e(n)})});throw Error("The reset token is no longer existed")}},actions.findUser().then(actions.changePassword)}},function(e,t,n){var a,s,i=n(35);n(34),n(14),a=n(38),s=n(5).getconfig(),e.exports=function(e){var t=n(8).getModel(),o={checkUser:function(){return new i(function(n,a){return console.log("check user"),e.username&&e.email&&e.password?t.findOne({username:e.username}).exec().then(function(s){return s?a(Error("AlreadyRegisterUsername")):t.findOne({email:e.email}).exec().then(function(e){return e?a(Error("AlreadyRegisterEmail")):n(!0)},function(e){return a(e)})},function(e){return a(e)}):a(Error("InvalidParameters"))})},createUser:function(n){e.emailToken=null,console.log("asfwefer"),console.log(e);var a=new t(e);return new i(function(e,t){return a.save(function(n){return n?t(n):e(a)})})},sendEmail:function(e){return console.log("---------------------------------sendmail-----------------------------------------------"),a.sendMail({from:"FundingPort<"+s.email.from+">",to:e.email,subject:"Your Email Verification",html:'Please click to <a href="'+s.host+"/confirmEmail?token="+e.emailToken+'">Verify your account</a>'},function(e,t){console.log("send email ID"),e&&console.log(e),console.log("Confirmation Mail Sent : "+t.response)}),e}};return o.checkUser().then(o.createUser)}},function(e,t,n){e.exports=function(e,t){e=e.Router();var a=n(6).getModel();return e.get("/",function(e,t){var n={};void 0!==e.query.id&&(n._id=e.query.id),a.find(n).exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),e={},e.results=n,t.send(e))})}),e.post("/",function(e,t){console.log(e.body),new a(e.body).save(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("team creation success"),t.json({status:"success"}))})}),e.put("/:id",function(e,t){console.log(e.body),a.findOneAndUpdate({_id:e.params.id},e.body,function(e,n){e?t.send({status:"error"}):(console.log("team update success"),t.json({status:"success"}))})}),e.put("/",function(e,t){console.log(e.body);var n=e.body;a.find({_id:n.team_id}).exec(function(e,s){e?console.log(e):(console.log("success"),e=s[0],e.active_players.push(n.player_id),a.update({_id:e._id},e).exec(function(e,n){e?console.log(e):(console.log("successfully pushed"),t.send("success"))}))})}),e.post("/removeplayer",function(e,t){e=e.body,console.log(e),a.update({_id:e.id},{active_players:e.data}).exec(function(e,n){e?console.log(e):(console.log("successfully deleted"),t.send("deleted successfully"))})}),e.get("/teamplayers",function(e,t){a.find({_id:e.query.teamid}).populate(["active_players"]).exec(function(e,n){e?t.send(e):t.send(n)})}),e.delete("/deleteteam",function(e,t){a.deleteOne({_id:e.query.id}).exec(function(e,n){e?console.log(e):t.send({result:"success"})})}),e}},function(e,t,n){e.exports=function(e,t){var a,s,i,o;return e=e.Router(),a=n(6).getModel(),s=n(7).getModel(),a=n(6).getModel(),i=n(2).getModel(),o=n(1),e.get("/",function(e,t){o({url:"https://criclive-api.herokuapp.com/"},function(e,n,o){function r(e){if(0<e.length){var n=e.pop();s.findOneAndUpdate({tournament_name:n.category},{tournament_name:n.category,overs:0},{upsert:!0,new:!0},function(s,o){if(s)return t.send(s),"";var c=function(t){if(0<t.length){var s=t.pop(),o={team_name:s.team2.name};a.findOneAndUpdate({team_name:s.team1.name},{team_name:s.team1.name},{upsert:!0,new:!0},function(e,t){if(e)console.log(e);else{var r=t._id;a.findOneAndUpdate({team_name:s.team2.name},o,{upsert:!0,new:!0},function(e,t){if(e)console.log(e);else{var a=t._id;i.findOne({date:s.date,$or:[{"team_2.teamid":a},{"team_1.teamid":r},{$or:[{"team_1.teamid":r},{"team_2.teamid":a}]}]}).exec(function(e,t){var o,d,u,m,p,_,f,y,g;e?console.log("match find error"):(console.log(s),o=e=0,d=0,u=0,m=0,p=0,_=0,f=0,null!=s.team1.score&&(y=s.team1.score.split(" "),1==y.length&&(e=parseInt(y[0])),3==y.length&&(e=parseInt(y[0]),d=parseInt(y[0].split("/")),d=parseInt(parseInt(y[0].split("/")[1])),g=y[1].split("("),m=g[1].split("/")[0].split(".")[0],2==g[1].split("/")[0].split(".").length&&(_=g[1].split("/")[0].split(".")[1])),4==y.length?(parseInt(y[0]),e=parseInt(y[2])):5==y.length&&(parseInt(y[0]),d=y[2].split("/"),e=parseInt(d[0]),d=parseInt(d[1]),m=y[3].split("(")[1])),null!=s.team2.score&&(y=s.team2.score.split(" "),1==y.length&&(o=parseInt(y[0])),3==y.length&&(o=parseInt(y[0]),u=parseInt(y[0].split("/")),u=parseInt(y[0].split("/")[1]),g=y[1].split("("),p=g[1].split("/")[0].split(".")[0],2==g[1].split("/")[0].split(".").length&&(f=g[1].split("/")[0].split(".")[1])),4==y.length?(parseInt(y[0]),o=parseInt(y[2])):5==y.length&&(parseInt(y[0]),u=y[2].split("/"),o=parseInt(u[0]),u=parseInt(u[1]),p=y[3].split("(")[1])),t?(t.team_1.teamid==r?(t.team_1.scores=e,t.team_1.overs=m,t.team_1.wickets=d):(t.team_2.scores=e,t.team_2.overs=m,t.team_2.wickets=d),t.team_1.balls=_,t.team_2.scores=o,t.team_2.overs=p,t.team_2.wickets=u,t.team_2.balls=f,t.tournament=l,console.log("updatematch",t),i.update({_id:t._id},t).exec(function(e,t){e||c(n.matches)})):(t={status:s.status,date:s.date,tournament:l,team_1:{teamid:r,scores:e,overs:m,wickets:d,balls:_},team_2:{teamid:a,scores:o,overs:p,wickets:u,balls:f}},console.log("creatematch",t),new i(t).save(function(e,t){e?console.log(e):c(n.matches)})))})}})}})}else r(e)},l=o._id;c(n.matches)})}else t.send({status:"success"})}e=JSON.parse(n.body),r(e.data)})}),e}},function(e,t,n){e.exports=function(e,t){e=e.Router(),n(1),n(17),n(6).getModel(),n(7).getModel(),n(2).getModel(),n(3).getModel(),n(4).getModel();var a=n(36);return e.get("/matches",function(e,t){a.matches(e.app.get("socketio"),function(e){t.send(e)})}),e.get("/scores",function(e,t){a.scores(e.app.get("socketio"),function(e){t.send(e)})}),e}},function(e,t,n){e.exports=function(e,t){e=e.Router();var a=n(4).getModel();return e.get("/",function(e,t){var n={};void 0!==e.query.match_id&&(n.match_id=e.query.match_id),a.find(n).exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),e={},e.results=n,t.send(e))})}),e.post("/",function(e,t){console.log(e.body),e=e.body,e.created_At=new Date,new a(e).save(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),t.json({status:"success",commentary_id:n._id}))})}),e.put("/:commentary_id",function(e,t){var n=e.params.commentary_id;e.body.updated_At=new Date,a.findOneAndUpdate({_id:n},e.body,{},function(e,n){e?t.send({status:"error"}):t.send({status:"success",data:n})})}),e.delete("/:commentary_id",function(e,t){console.log("remove called"),a.find({_id:e.params.commentary_id}).remove().exec(function(e,n){e?t.send({status:"error"}):t.send({status:"success"})})}),e}},function(e,t,n){e.exports=function(e,t){return e=e.Router(),e.post("/new/:projectid",function(e,t){console.log("new email request recevied");var a=n(15).getModel(),s={projectid:e.params.projectid,clientid:e.body.clientid};e.query.receipientemail&&(s.receipientemail=e.query.receipientemail),e.query.projectleadid&&(s.projectleadid=e.query.projectleadid),new a(s).save(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success",n),t.status(200).send({message:"success",emailid:n._id}))})}),e.post("/:projectid/:emailid",function(e,t){var a,s,i,o,r,c,l,d,u,m,p,_,f,y;console.log("send email request recevied"),console.log(e.body),a=[],s=n(5).getconfig(),n(21).getModel(),i=n(15).getModel(),o=n(63),r=e.params.projectid,c=e.params.emailid,l=void 0!==e.body.clientid?e.body.clientid:"",d=void 0!==e.body.projectleadid?e.body.projectleadid:"",u=void 0!==e.body.campaignid?e.body.campaignid:"",m=void 0!==e.body.receipientemail?e.body.receipientemail:"",p=void 0!==e.body.subject?e.body.subject:"",_=void 0!==e.body.message?e.body.message:"",f=void 0!==e.body.casessionid?e.body.casessionid:"",a=void 0!==e.body.attachmentlinks?e.body.attachmentlinks:[],y=void 0!==e.body.causerid?e.body.causerid:"",console.log("attachments1",a),r&&m&&p&&_?(console.log("attachments2",a),Projects.findOne({_id:r},function(g,h){var b,v,w,x;if(console.log("attachments3",a,r,e.params),g)console.log(g),t.send('{"status": "error"}');else{for(console.log("success",h),h.smtp.template="blank",console.log("attachmentlinks",a),b={projectid:r,projectleadid:d,clientid:l,campaignid:u,receipientemail:m,subject:p,message:_,casessionid:f,causerid:y,attachmentlinks:a},h.projectleadid=d,g=n(37),v={emailid:c,projectleadid:d,receipientemail:m},console.log("trackid :",v),w=""+g.AES.encrypt(JSON.stringify(v),"fusioncorpisclofus"),v=s.service.baseurl+"/api/"+s.service.apiversion+"/attachment/default.png?param="+encodeURIComponent(w),console.log("encrypted_trackid",w),console.log("trackerimage",v),console.log("attachmentlinks--",a),i.findOneAndUpdate({_id:c},b,function(e,t){e?console.log("error",e):console.log("success")}),b=0;b<a.length;b++)x=""+decodeURIComponent(a[b].split("/")[6]),w=a[b].split("/")[7],x=g.AES.decrypt(x,"fusioncorpisclofus"),x=JSON.parse(x.toString(g.enc.Utf8)),x.receipientemail=m,x.emailid=c,x.projectleadid=d,x=""+g.AES.encrypt(JSON.stringify(x),"fusioncorpisclofus"),a[b]=s.service.baseurl+"/api/"+s.service.apiversion+"/attachment/"+w+"?param="+encodeURIComponent(x);console.log("attachmentlinks3--",a,h),o.sendEmail(h,m,p,_,"","",a,v,function(e,n){return console.log(e,n),t.status(200).send({message:"success"})})}})):t.send('{"status": "invalid_request"}')}),e.get("/:emailid",function(e,t){n(15).getModel().findOne({_id:e.params.emailid}).exec(function(e,n){e?t.send('{"status": "error"}'):t.status(200).send({status:"success",email:n})})}),e}},function(e,t,n){(function(t){e.exports={sendEmail:function(e,a,s,i,o,r,c,l,d){var u,m,p,_,f,y,g,h,b=n(13);for(n(5).getconfig(),u=n(34),m=n(39),p=n(12),_=e.smtp,console.log("email config",_),f={host:_.host,port:_.port,auth:{user:_.username,pass:_.password}},y=n(64),y.registerHelper("inc",function(e,t){return void 0===e||null===e?null:e+(t.hash.inc||1)}),g=u.createTransport(m(f)),h=[],u=0;u<c.length;u++)console.log("all_links",c[u]),m=c[u].split("?")[0].split("/attachment/")[1],m={filename:m.split("__")[0]+"."+m.split(".")[1],path:c[u]},h.push(m);!function(n,a){var s,i="blank";_.template&&(i=_.template),s=t+"/../templates/signature.html",b.readFile(t+"/../templates/"+i+".html",function(t,i){if(t)throw t;var o=y.compile(""+i)(n);o=o.split("<table").join('<table style="border: 1px solid black; width: 70%;"'),o=o.replace("<tr",'<tr style="border: 1px solid black;background: #999999;color: #fff;"'),o=o.split("<th").join('<th style="border: 1px solid black;"'),o=o.split("<td").join('<td style="border: 1px solid black; padding: 15px;"'),b.readFile(s,function(t,n){if(t)throw t;$=p.load(n),$("a").each(function(){console.log("this.href",this.attribs.href),$(this).attr("href",this.attribs.href+"?projectleadid="+e.projectleadid)}),o+=$.html(),console.log("GENERATED HTML",o),a(t,o)})})}({subject:s,message:i,calltoaction_link:o,calltoaction_text:r,trackerimage:l,attachments:h},function(e,t){e={from:_.from,to:a,subject:s,html:t,attachments:h},e.attachments=[],console.log("emaildata",e),g.sendMail(e,function(e,t){e?(console.log(e),d("error",e)):(console.log("Message sent: "+t.message+" to "+a),d("success",t.message))})})}}}).call(t,"/")},function(e,t){e.exports=require("handlebars")},function(e,t,n){e.exports=function(e,t){var a,s;return e=e.Router(),a=n(40),a.mongo=t.mongo,s=new a(t.connection.db),t=n(41),a=t.memoryStorage(),n(37),t=t({storage:a}),n(13),e.post("/upload",t.single("file"),function(e,t){var a,i;n(5).getconfig(),a="",a=void 0!==e.file.originalname?e.file.originalname.replace(" ","_").split(".")[0]:void 0!==e.file.filename?e.file.filename.replace(" ","_").split(".")[0]:"attachment",i=a+"__"+(new Date).getTime()+"_"+Math.round(1e3*Math.random())+"."+e.file.mimetype.split("/")[1],a=s.createWriteStream({filename:i,mode:"w",content_type:e.file.mimetype}),a.on("close",function(){t.send({status:"success",filename:i})}),a.write(e.file.buffer),a.end()}),e.get("/:filename",function(e,t){console.log("sdsdvsdv222"),n(21).getModel(),s.files.find({filename:e.params.filename}).toArray(function(e,n){if(0===n.length)return t.status(400).send({message:"File not found"});t.writeHead(200,{"Content-Type":n[0].contentType}),e=s.createReadStream({filename:n[0].filename}),e.on("data",function(e){t.write(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){throw console.log("An error occurred!",e),e})})}),e}},function(e,t,n){e.exports=function(e,t){var a,s,i;return e=e.Router(),a=n(26).getModel(),s=n(40),s.mongo=t.mongo,i=new s(t.connection.db),t=n(41),s=t.memoryStorage(),n(37),t=t({storage:s}),n(13),e.get("/",function(e,t){a.find({}).exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),e={},e.results=n,t.send(e))})}),e.get("/:event",function(e,t){a.findOne({event:e.params.event}).exec(function(e,n){!e&&n&&i.files.find({filename:n.filename}).toArray(function(e,n){if(0===n.length)return t.status(400).send({message:"File not found"});t.writeHead(200,{"Content-Type":n[0].contentType}),e=i.createReadStream({filename:n[0].filename}),e.on("data",function(e){t.write(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){throw console.log("An error occurred!",e),e})})})}),e.post("/upload",t.single("file"),function(e,t){var n,a;console.log(e.file),n="",n=void 0!==e.file.originalname?e.file.originalname.replace(" ","_").split(".")[0]:void 0!==e.file.filename?e.file.filename.replace(" ","_").split(".")[0]:"attachment",a=n+"__"+(new Date).getTime()+"_"+Math.round(1e3*Math.random())+"."+e.file.mimetype.split("/")[1],n=i.createWriteStream({filename:a,mode:"w",content_type:e.file.mimetype}),n.on("close",function(){var e={filename:a};return t.status(200).send({status:"success",result:e})}),n.write(e.file.buffer),n.end()}),e.put("/:gif_id",function(e,t){console.log(e.body);var n=e.body;n.updated_At=new Date,a.findOneAndUpdate({_id:e.params.gif_id},n,{},function(e,n){e?t.send({status:"error"}):t.send({status:"success",data:n})})}),e}},function(e,t,n){e.exports=function(e,t){var a,s,i,o,r,c;return e=e.Router(),a=n(2).getModel(),s=n(11).getModel(),i=n(4).getModel(),o=n(10),r=n(3).getModel(),o=n(10),c=n(28),e.get("/",function(e,t){a.find({}).exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),e={},e.results=n,t.send(e))})}),e.get("/getmatchdetails",function(e,t){console.log("Get all upcoming matches");var n={};void 0===e.query.filter&&(n.match_view_status="active"),void 0!==e.query.tournament&&(n.tournament=e.query.tournament),void 0!==e.query.scoreupdate&&(n.scoreupdate=e.query.scoreupdate),console.log(n),console.time("getmatches"),a.find(n).populate("team_1.teamid").populate("team_2.teamid").populate("tournament").exec(function(e,n){console.timeEnd("getmatches"),e?t.send(e):t.send(n.reverse())})}),e.get("/matchdetaillist",function(e,t){a.find({_id:e.query.matchid}).populate("team_1.teamid").populate("team_2.teamid").populate("tournament").exec(function(e,n){e?t.send(e):t.send(n)})}),e.get("/scorelist/:id",function(e,t){o.sendscorecard(e,t,{match:a,scores:s,Commentaries:i,scoresauto:r},"http")}),e.post("/",function(e,t){new a(e.body).save(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("match creation success"),t.send("success"))})}),e.put("/tossupdate",function(e,t){var n,i;console.log("details",e.body),n=e.body,1==n.team_1.status||"0"==n.team_2.status?i=n.team_1.teamid._id:1!=n.team_2.status&&"0"!=n.team_1.status||(i=n.team_2.teamid._id),a.update({_id:n._id},n).exec(function(e,a){e?console.log(e):(e={},e.match_id=n._id,e.team=i,new s(e).save(function(e,n){e?console.log(e):(console.log("save",n),t.send("success"))}))})}),e.put("/updatesession",function(e,t){var n=e.body;a.update({_id:n._id},n).exec(function(l,d){l?console.log(l):(o.sendscorecard(e,t,{matchID:n._id,match:a,scores:s,scoresauto:r,Commentaries:i},"socketio"),c.pushsession({matchdetails:n},function(){}),t.send({status:"success"}))})}),e.put("/changestatus",function(e,t){e=e.body,a.update({_id:e._id},e).exec(function(e,n){e?t.send({status:"error"}):t.send({status:"success"})})}),e.put("/",function(e,t){var n,i=e.body;console.log(i),1==i.team_1.status||"0"==i.team_2.status?n=i.team_1.teamid._id:1!=i.team_2.status&&"0"!=i.team_1.status||(n=i.team_2.teamid._id),i.currentoverscore=0,a.update({_id:i._id},i).exec(function(e,a){e?(console.log(e),t.send('{"status": "error"}')):(e={},e.match_id=i._id,e.team=n,new s(e).save(function(e,n){e?console.log(e):(console.log("match update success"),t.send("success"))}))})}),e.delete("/deletematch",function(e,t){a.deleteOne({_id:e.query.id}).exec(function(e,n){e?t.send(e):t.send({result:"success"})})}),e.put("/targetupdate",function(e,t){console.log("req",e.body);var n=e.body.team;a.findOne({_id:e.body.matchid}).exec(function(e,a){e?t.send(e):(console.log("matchdata",a),a.team_1.status?(a.team_1.totalovers=n.totalovers,a.team_1.targetscore=n.targetscore):(a.team_2.totalovers=n.totalovers,a.team_2.targetscore=n.targetscore),a.save(function(e){console.log("err")}),t.send({status:"success"}))})}),e.post("/change/to/auto",function(e,t){a.findOne({_id:e.body.selectedmatch}).exec(function(n,s){n?t.send({status:"error",results:{}}):(n=JSON.parse(JSON.stringify(s)),delete n._id,console.log("Selected Match"),console.log(n),a.update({_id:e.body.tomatchID},n,function(e,n){e?(console.log(e),t.send({status:"error"})):t.send({status:"success"})}))})}),e}},function(e,t,n){e.exports=function(e,t){e=e.Router();var a=n(16).getModel(),s=n(29);return e.get("/latest",function(e,t){a.find({}).sort("-created_At").exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),e={},e.results=n,t.send(e))})}),e.get("/create",function(e,t){s.fetch({},function(e){t.send(e)})}),e}},function(e,t,n){e.exports=function(e,t){e=e.Router();var a=n(23).getModel(),s=n(2).getModel();return e.get("/",function(e,t){a.find({}).exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),e={},e.results=n,t.send(e))})}),e.get("/getteamplayers",function(e,t){s.find({_id:e.query.id}).populate("tournament").populate({path:"team_1.teamid",model:"activeteam",populate:{path:"active_players",model:"playerlist"}}).populate({path:"team_2.teamid",model:"activeteam",populate:{path:"active_players",model:"playerlist"}}).exec(function(e,n){e?t.send('{"status": "error"}'):t.send(n)})}),e.post("/createplayer",function(e,t){console.log(e.body),new a(e.body).save(function(e,n){e?console.log(e):t.send({result:"success"})})}),e.delete("/deleteplayer",function(e,t){a.deleteOne({_id:e.query.id}).exec(function(e,n){e?console.log(e):t.send({result:"success"})})}),e}},function(e,t,n){e.exports=function(e,t){var a,s,i,o,r;return e=e.Router(),a=n(2).getModel(),s=n(3).getModel(),i=n(11).getModel(),o=n(4).getModel(),n(29),r=n(10),e.get("/",function(e,t){console.log("websocket push data"),r.sendscorecard({},{},{matchID:e.query.match_id,match:a,scores:i,scoresauto:s,Commentaries:o,socketio:e.app.get("socketio")},"socketio"),console.log("push requested"),t.send('{"status": "error"}')}),e}},function(e,t,n){e.exports=function(e,t){e=e.Router(),n(23).getModel();var a=n(2).getModel(),s=n(11).getModel(),i=n(3).getModel(),o=n(4).getModel(),r=n(10);return e.put("/openingbatsman",function(e,t){var n=e.body,a={match_id:n.match_id,team:n.team};s.find(a).exec(function(e,i){e?(console.log(e),t.send('{"status": "error"}')):0==i.length?new s(n).save(function(e,n){e?console.log(e):t.send("success")}):s.update(a,{batsman_id:n.batsman_id,active_batsman:n.active_batsman}).exec(function(e,n){e?console.log(e):(console.log("successfull"),t.send("success"))})})}),e.put("/openingbowler",function(e,t){var n=e.body,a={match_id:n.match_id,team:n.team};s.find(a).exec(function(e,i){e?(console.log(e),t.send('{"status": "error"}')):0==i.length?new s(n).save(function(e,n){e?console.log(e):t.send("success")}):s.update(a,{active_bowler:n.active_bowler}).exec(function(e,n){e?console.log(e):(console.log("successfull"),t.send("success"))})})}),e.post("/nextball",function(e,t){var n,c,l=e.body;void 0===l.event.noball&&void 0===l.event.wide&&(l.balls?5>l.balls?l.balls+=1:5==l.balls&&(l.balls=0,l.overs+=1):l.balls=1),n=l.active_batsman,c=l.active_bowler,0!=l.event.wicket&&void 0!==l.event.wicket_type?l.batsman_id.splice(l.batsman_id.indexOf(l.active_batsman._id),1):0==l.event.wicket&&"retiered"==l.event.wicket_type&&l.batsman_id.splice(l.batsman_id.indexOf(l.active_batsman._id),1),new s(l).save(function(d,u){d?(console.log(d),t.send({status:"error"})):a.findOne({_id:l.match_id}).exec(function(d,u){var m,p,_,f;if(d)t.send({status:"error"});else{if(d=1,"3"!=u.innings.current&&"4"!=u.innings.current||(d=2),void 0!==l.event.noball||void 0!==l.event.wide?(m=1,p=Object.keys(l.event),1<p.length&&(m+=l.event[Object.keys(l.event)[1]])):void 0!==l.event.freehit?(m=0,p=Object.keys(l.event),1<p.length&&(m+=l.event[Object.keys(l.event)[1]])):m=void 0!==l.event.wicket?0:l.event[Object.keys(l.event)[0]],console.log(m),u.team_1.status){if(u.team_1.balls=l.balls,u.team_1.overs=l.overs,u.team_1.scores+=m,u.currentoverscore+=m,p=0,void 0!==l.event.noball||void 0!==l.event.wide?(p=0,"undefined"!=l.event.noball?u.team_1.noball+=1:"undefined"!=l.event.wide&&(u.team_1.wide+=1)):p=1,void 0===l.event.noball&&void 0===l.event.wide){for(_=!1,void 0===u.team_1.fall_of_wickets&&(u.team_1.fall_of_wickets=[]),f=0;f<u.team_1.scorecard.length;f++)if(u.team_1.scorecard[f].player_id==n._id){_={innings:d,player_id:n._id,player_name:n.player_name,score:u.team_1.scorecard[f].score+m,balls:u.team_1.scorecard[f].balls+p,sixes:u.team_1.scorecard[f].sixes,fours:u.team_1.scorecard[f].fours,playing:!0},_.strike_rate=_.score/_.balls*100,void 0!==l.event.six&&(console.log("six",void 0!==l.event.six),_.sixes=u.team_1.scorecard[f].sixes+1),void 0!==l.event.four&&(console.log("four",void 0!==l.event.four),_.fours=u.team_1.scorecard[f].fours+1),0!=l.event.wicket&&void 0!==l.event.wicket_type?(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes,u.team_1.fall_of_wickets.push({innings:d,player_id:n._id,player_name:n.player_name,overs:l.overs,balls:l.balls,wicket_position:u.team_1.wickets+1,score:u.team_1.scores})):0==l.event.wicket&&"retiered"==l.event.wicket_type&&(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes),u.team_1.scorecard.splice(f,1),u.team_1.scorecard.push(_),_=!0;break}0==_&&(_={innings:d,player_id:n._id,player_name:n.player_name,score:m,balls:p,playing:!0},_.strike_rate=_.score/_.balls*100,void 0!==l.event.six&&(console.log("six",void 0!==l.event.six),_.sixes=1),void 0!==l.event.four&&(console.log("four",void 0!==l.event.four),_.fours=1),0!=l.event.wicket&&void 0!==l.event.wicket_type?(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes):0==l.event.wicket&&"retiered"==l.event.wicket_type&&(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes),u.team_1.scorecard.push(_))}if(void 0===l.event.noball&&void 0===l.event.wide){if(_=!1,0<u.team_1.bowler_scorecard.length)for(f=0;f<u.team_1.bowler_scorecard.length;f++)if(u.team_1.bowler_scorecard[f].player_id==c._id){_={player_id:c._id,innings:d,player_name:c.player_name,runs:u.team_1.bowler_scorecard[f].runs+m,balls:u.team_1.bowler_scorecard[f].balls+p,playing:!0},0!=l.event.wicket&&void 0!==l.event.wicket_type&&(_.numberofwickets=u.team_1.bowler_scorecard[f].numberofwickets+1),0<_.balls&&(_.economy=_.runs/_.balls),void 0===u.team_1.bowler_scorecard[f].maiden?u.team_1.bowler_scorecard[f].maiden=0:_.maiden=u.team_1.bowler_scorecard[f].maiden,0==u.currentoverscore&&0==l.balls&&(_.maiden=u.team_1.bowler_scorecard[f].maiden+1),0==l.balls&&(u.currentoverscore=0),console.log("MAIDEN OVER OLD TEAM 1"),console.log("currentscore",u.currentoverscore),console.log("balls",l.balls),console.log(_),u.team_1.bowler_scorecard.splice(f,1),u.team_1.bowler_scorecard.push(_),_=!0;break}0==_&&(_={player_id:c._id,innings:d,player_name:c.player_name,runs:m,balls:p,playing:!0},0!=l.event.wicket&&void 0!==l.event.wicket_type&&(_.numberofwickets=1),0<p&&(_.economy=m/p),0==u.currentoverscore&&0==l.balls&&(_.maiden=1,u.currentoverscore=0),0==l.balls&&(u.currentoverscore=0),console.log("MAIDEN OVER NEW"),console.log("currentscore",u.currentoverscore),console.log("balls",l.balls),u.team_1.bowler_scorecard.push(_))}0!=l.event.wicket&&void 0!==l.event.wicket_type&&"retiered"!=l.event.wicket_type&&(u.team_1.wickets+=1,u.team_1.scores-=m)}else{if(u.team_2.balls=l.balls,u.team_2.overs=l.overs,u.team_2.scores+=m,u.currentoverscore+=m,p=0,void 0!==l.event.noball||void 0!==l.event.wide?(p=0,"undefined"!=l.event.noball?u.team_2.noball+=1:"undefined"!=l.event.wide&&(u.team_2.wide+=1)):p=1,void 0===l.event.noball&&void 0===l.event.wide){for(_=!1,f=0;f<u.team_2.scorecard.length;f++)if(u.team_2.scorecard[f].player_id==n._id){_={innings:d,player_id:n._id,player_name:n.player_name,score:u.team_2.scorecard[f].score+m,balls:u.team_2.scorecard[f].balls+p,sixes:u.team_2.scorecard[f].sixes,fours:u.team_2.scorecard[f].fours,playing:!0},_.strike_rate=_.score/_.balls*100,void 0!==l.event.six&&(console.log("six",void 0!==l.event.six),_.sixes=1),void 0!==l.event.four&&(console.log("four",void 0!==l.event.four),_.fours=1),0!=l.event.wicket&&void 0!==l.event.wicket_type?(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes):0==l.event.wicket&&"retiered"==l.event.wicket_type&&(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes),console.log(_),u.team_2.scorecard.splice(f,1),u.team_2.scorecard.push(_),_=!0;break}0==_&&(_={innings:d,player_id:n._id,player_name:n.player_name,score:m,balls:p,playing:!0},_.strike_rate=_.score/_.balls*100,void 0!==l.event.six&&(console.log("six",void 0!==l.event.six),_.sixes=u.team_2.scorecard[f].sixes+1),void 0!==l.event.four&&(console.log("four",void 0!==l.event.four),_.fours=u.team_2.scorecard[f].fours+1),0!=l.event.wicket&&void 0!==l.event.wicket_type?(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes,u.team_2.fall_of_wickets.push({innings:d,player_id:n._id,player_name:n.player_name,overs:l.overs,balls:l.balls,wicket_position:u.team_2.wickets+1,score:u.team_2.scores})):0==l.event.wicket&&"retiered"==l.event.wicket_type&&(_.wicket=l.event.wicket,_.wicket_type=l.event.wicket_type,_.wicket_by=l.event.wicket_notes),u.team_2.scorecard.push(_))}if(void 0===l.event.noball&&void 0===l.event.wide){if(_=!1,0<u.team_2.bowler_scorecard.length)for(f=0;f<u.team_2.bowler_scorecard.length;f++)if(u.team_2.bowler_scorecard[f].player_id==c._id){_={innings:d,player_id:c._id,player_name:c.player_name,runs:u.team_2.bowler_scorecard[f].runs+m,balls:u.team_2.bowler_scorecard[f].balls+p,playing:!0},0<_.balls&&(_.economy=_.runs/_.balls),void 0===u.team_2.bowler_scorecard[f].maiden?u.team_2.bowler_scorecard[f].maiden=0:_.maiden=u.team_2.bowler_scorecard[f].maiden,0==u.currentoverscore&&0==l.balls&&(_.maiden=u.team_2.bowler_scorecard[f].maiden+1),0==l.balls&&(u.currentoverscore=0),console.log("MAIDEN OVER OLD TEAM 2"),console.log("currentscore",u.currentoverscore),console.log("balls",l.balls),console.log(_),0!=l.event.wicket&&void 0!==l.event.wicket_type&&(_.numberofwickets=u.team_2.bowler_scorecard[f].numberofwickets+1),u.team_2.bowler_scorecard.splice(f,1),u.team_2.bowler_scorecard.push(_),_=!0;break}0==_&&(_={innings:d,player_id:c._id,player_name:c.player_name,runs:m,balls:p,playing:!0},0!=l.event.wicket&&void 0!==l.event.wicket_type&&(_.numberofwickets=1),0<p&&(_.economy=m/p),0==u.currentoverscore&&0==l.balls&&(_.maiden=1),0==l.balls&&(u.currentoverscore=0),u.team_2.bowler_scorecard.push(_))}0!=l.event.wicket&&void 0!==l.event.wicket_type&&"retiered"!=l.event.wicket_type&&(u.team_2.wickets+=1,u.team_2.scores-=m)}a.update({_id:l.match_id},u).exec(function(n,c){n?t.send({status:"error"}):(r.sendscorecard(e,t,{matchID:l.match_id,match:a,scores:s,scoresauto:i,Commentaries:o},"socketio"),t.send({status:"success"}))})}})})}),e.put("/previousball",function(e,t){var n=e.body;console.log("prescore",n),s.deleteOne({match_id:n.match_id,overs:n.overs,balls:n.balls}).exec(function(e,s){e?console.log(e):a.findOne({_id:n.match_id}).exec(function(e,a){if(e)t.send({status:"err"});else{if(0<(e=n.event.one+n.event.two+n.event.three+n.event.four+n.event.six))if(console.log(e),a.team_1.status){0==a.team_1.balls?(a.team_1.balls=5,--a.team_1.overs):0<a.team_1.balls&&--a.team_1.balls,a.team_1.scores-=e,a.currentoverscore-=e;for(var s=0;s<a.team_1.scorecard.length;s++)a.team_1.scorecard[s].player_id==n.active_batsman&&(a.team_1.scorecard[s].score-=e,--a.team_1.scorecard[s].balls);for(s=0;s<a.team_1.bowler_scorecard.length;s++)a.team_1.bowler_scorecard[s].player_id==n.active_bowler&&(a.team_1.bowler_scorecard[s].runs-=e,--a.team_1.bowler_scorecard[s].balls,a.team_1.bowler_scorecard[s].economy=a.team_1.bowler_scorecard[s].runs/a.team_1.bowler_scorecard[s].balls)}else{for(0==a.team_2.balls?(a.team_2.balls=5,--a.team_2.overs):0<a.team_2.balls&&--a.team_2.balls,a.team_2.scores-=e,a.currentoverscore-=e,s=0;s<a.team_2.scorecard.length;s++)a.team_2.scorecard[s].player_id==n.active_batsman&&(a.team_2.scorecard[s].score-=e,--a.team_2.scorecard[s].balls);for(s=0;s<a.team_2.bowler_scorecard.length;s++)a.team_2.bowler_scorecard[s].player_id==n.active_bowler&&(a.team_2.bowler_scorecard[s].runs-=e,--a.team_2.bowler_scorecard[s].balls,a.team_2.bowler_scorecard[s].economy=a.team_2.bowler_scorecard[s].runs/a.team_2.bowler_scorecard[s].balls)}if(0<n.event.wicket)if(a.team_1.status){for(--a.team_1.wickets,0==a.team_1.balls?(a.team_1.balls=5,--a.team_1.overs):0<a.team_1.balls&&--a.team_1.balls,e=0;e<a.team_1.scorecard.length;e++)a.team_1.scorecard[e].player_id==n.active_batsman&&(a.team_1.scorecard[e].wicket=0,a.team_1.scorecard[e].wicket_type="",a.team_1.scorecard[e].wicket_by="",--a.team_1.scorecard[e].balls);for(e=0;e<a.team_1.fall_of_wickets.length;e++)if(a.team_1.fall_of_wickets[e].player_id==n.active_batsman){a.team_1.fall_of_wickets.splice(e,1);break}for(e=0;e<a.team_1.bowler_scorecard.length;e++)a.team_1.bowler_scorecard[e].player_id==n.active_bowler&&(--a.team_1.bowler_scorecard[e].numberofwickets,--a.team_1.bowler_scorecard[e].balls)}else{for(--a.team_2.wickets,0==a.team_2.balls?(a.team_2.balls=5,--a.team_2.overs):0<a.team_2.balls&&--a.team_2.balls,e=0;e<a.team_2.scorecard.length;e++)a.team_2.scorecard[e].player_id==n.active_batsman&&(a.team_2.scorecard[e].wicket=0,a.team_2.scorecard[e].wicket_type="",a.team_2.scorecard[e].wicket_by="",--a.team_2.scorecard[e].balls);for(e=0;e<a.team_2.fall_of_wickets.length;e++)if(a.team_2.fall_of_wickets[e].player_id==n.active_batsman){a.team_2.fall_of_wickets.splice(e,1);break}for(e=0;e<a.team_2.bowler_scorecard.length;e++)a.team_2.bowler_scorecard[e].player_id==n.active_bowler&&(--a.team_2.bowler_scorecard[e].numberofwickets,--a.team_2.bowler_scorecard[e].balls)}if(0<n.event.noball||0<n.event.wide)if(a.team_1.status)for(--a.team_1.scores,e=0;e<aatchscore.team_1.scorecard.length;e++)a.team_1.scorecard[e].player_id==n.active_batsman&&--a.team_1.scorecard[e].score;else for(--a.team_2.scores,e=0;e<aatchscore.team_2.scorecard.length;e++)a.team_2.scorecard[e].player_id==n.active_batsman&&--a.team_2.scorecard[e].score;a.save(function(e){console.log("save")}),t.send({status:"success"})}})})}),e.put("/updatescore",function(e,t){e=e.body,s.update({match_id:e.match_id},e).exec(function(e,n){e?console.log(e):(console.log("successfull"),t.send("success"))})}),e.put("/updatescorecard",function(e,t){var n=e.body.scorecard,s=e.body.teamid;a.find({_id:e.body.matchid}).exec(function(e,a){if(e)console.log("find error",e);else{if(e=a[0],e.team_1.teamid==s)for(a=0;a<e.team_1.scorecard.length;a++)e.team_1.scorecard[a].player_id==n.player_id&&(e.team_1.scorecard.splice(a,1),e.team_1.scorecard.push(n));else if(e.team_2.teamid==s)for(a=0;a<e.team_2.scorecard.length;a++)e.team_2.scorecard[a].player_id==n.player_id&&(e.team_2.scorecard.splice(a,1),e.team_2.scorecard.push(n));e.save(function(e,n){e?console.log(e):t.send({status:"success"})})}})}),e.put("/updatebowlerscorecard",function(e,t){var n=e.body.scorecard,s=e.body.teamid;a.find({_id:e.body.matchid}).exec(function(e,a){if(e)console.log("find error",e);else{if(e=a[0],e.team_1.teamid==s)for(a=0;a<e.team_1.bowler_scorecard.length;a++)e.team_1.bowler_scorecard[a].player_id==n.player_id&&(e.team_1.bowler_scorecard.splice(a,1),e.team_1.bowler_scorecard.push(n));else if(e.team_2.teamid==s)for(a=0;a<e.team_2.bowler_scorecard.length;a++)e.team_2.bowler_scorecard[a].player_id==n.player_id&&(e.team_2.bowler_scorecard.splice(a,1),e.team_2.bowler_scorecard.push(n));e.save(function(e,n){e?console.log(e):t.send({status:"success"})})}})}),e.get("/",function(e,t){a.find({match_id:e.query.matchid}).exec(function(e,n){e?(console.log(e),t.send("error")):t.send(n)})}),e.get("/scoredetail",function(e,t){e=e.query;var n={};void 0!==e.overs&&(n.overs=e.overs),void 0!==e.balls&&(n.balls=e.balls),void 0!==e.team&&(n.team=e.team),void 0!==e.match_id&&(n.match_id=e.match_id),s.find(n).populate("batsman_id").populate("bowler_id").populate("active_batsman").populate("active_bowler").populate("previous_bowler").populate("team").exec(function(e,n){e?(console.log(e),t.send("error")):t.send(n)})}),e}},function(e,t,n){e.exports=function(e,t){e=e.Router();var a=n(7).getModel();return e.get("/",function(e,t){a.find({}).exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("success"),e={},e.results=n,t.send(e))})}),e.post("/",function(e,t){console.log(e.body),new a(e.body).save(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):(console.log("team creation success"),t.send("success"))})}),e.delete("/deletetournament",function(e,t){a.deleteOne({_id:e.query.id}).exec(function(e,n){e?(console.log(e),t.send('{"status": "error"}')):t.send({result:"success"})})}),e}}]);